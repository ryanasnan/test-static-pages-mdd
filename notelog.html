

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>NoteLog &mdash; Docker and Kubernetes 1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/sphinxcontrib-httpexample.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/sphinxcontrib-httpexample.js"></script>
        <script src="_static/js/custom.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Glosarium" href="glosarium.html" />
    <link rel="prev" title="Docker MERN (Mongo Express React Node)" href="docker-mern.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Docker and Kubernetes
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="docker-intro.html">Pengenalan Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker-architecture.html">Arsitektur Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker-objects.html">Docker Objects (Image, Container, Volume, Networks)</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker-delete-objects.html">Menghapus Objects pada docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="dockerfile.html">Dockerfile</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker-compose.html">Docker compose</a></li>
<li class="toctree-l1"><a class="reference internal" href="dockerfile-vs-docker-container-compose.html">Dockerfile vs docker compose</a></li>
<li class="toctree-l1"><a class="reference internal" href="orchestration.html">Orchestration (Kubernetes)</a></li>
<li class="toctree-l1"><a class="reference internal" href="dockerfile-collection.html">Kumpulan Dockerfile</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker-laravel.html">Docker Laravel</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker-mern.html">Docker MERN (Mongo Express React Node)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">NoteLog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#konsep-php-nginx">konsep php nginx</a></li>
<li class="toctree-l2"><a class="reference internal" href="#konsep-api-address">Konsep api address</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mengapa-kalau-docker-build-harus-ada-context-path-asumsi">mengapa kalau docker build harus ada context path (asumsi)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mengapa-di-mysql-official-harus-memberikan-adanya-p">Mengapa di mysql official harus memberikan adanya -p</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mengapa-di-docker-php-image-pake-docker-php-ext-install">mengapa di docker php image pake docker-php-ext-install</a></li>
<li class="toctree-l2"><a class="reference internal" href="#melihat-history-log-di-linux">Melihat history log di linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="#redirection">redirection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cara-membuat-web-application-nginx-dengan-subdirectory">cara membuat web application (nginx) dengan subdirectory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ubuntu-vs-centos">ubuntu vs centos</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ubuntu-vs-centos-berani-pakai-centos">ubuntu vs centos, berani pakai centos ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#network-0-0-0-0">network 0.0.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="#volume-itu-akan-menghapus">volume itu akan menghapus</a></li>
<li class="toctree-l2"><a class="reference internal" href="#konsep-node-php-dan-service-backend">konsep node,php dan service backend</a></li>
<li class="toctree-l2"><a class="reference internal" href="#perbedaan-binary-dan-source-code">Perbedaan binary dan source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#apa-itu-alpine">apa itu alpine</a></li>
<li class="toctree-l2"><a class="reference internal" href="#kalau-serius-mau-buat-dockerfile">kalau serius mau buat dockerfile</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docker-push-new-repo">docker push new repo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docker-compose-restart-always-on-autostart">docker compose restart always (on autostart)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#menghilangkan-dengan-docker-compose-down">menghilangkan dengan docker-compose down</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#penjelasan-host">penjelasan host</a></li>
<li class="toctree-l2"><a class="reference internal" href="#masalah-php-dan-nginx-di-docker">masalah php dan nginx di docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="#docker-compose-adalah-seperti-halnya-docker-run">docker-compose adalah seperti halnya docker run</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jika-ingin-mount-volume-pastikan-file-yang-di-mount-bener-semua-terkadang-kalau-ada-dockerfile-bikin-error-saja">jika ingin mount volume pastikan file yang di mount bener semua, terkadang kalau ada Dockerfile bikin error saja</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jika-pas-di-docker-compose-up-itu-terkadang-ada-tambahan-misal-php-1-atau-web-1-nah-itu-juga-bisa-dijadikan-server-tersendiri-bisa-untuk-php-1-9000-pada-nginx">jika pas di docker compose up itu terkadang ada tambahan, misal php_1 atau web_1 nah itu juga bisa dijadikan server tersendiri (bisa untuk php_1:9000 pada nginx)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#php-extension-in-docker">php extension in docker</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gak-perlu-install-package-aneh-aneh">gak perlu install package aneh aneh</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#cors-dan-implementasi-proxy-di-react">CORS dan Implementasi Proxy di React</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cors-cross-origin-resource-sharing">CORS (Cross Origin Resource Sharing)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#origin">Origin</a></li>
<li class="toctree-l4"><a class="reference internal" href="#same-origin-policy-dalam-cors"><cite>Same-Origin policy</cite> dalam CORS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#menerapkan-akses-dengan-cors-control-allow-header-origin">Menerapkan akses dengan CORS (control allow header origin)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#serangan-csrf-dan-xsrf">Serangan CSRF dan XSRF</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kesimpulan-cors">Kesimpulan CORS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#react-proxy">React Proxy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bagaimana-react-menggunakan-proxy">Bagaimana React menggunakan <code class="docutils literal notranslate"><span class="pre">proxy</span></code> ?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#package-react-router-sejatinya-bukan-url-namun-hanya-semacam-routing-di-browser">Package <code class="docutils literal notranslate"><span class="pre">react-router</span></code> sejatinya bukan url namun hanya semacam <cite>routing</cite> di browser</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hal-ini-tidak-berlaku-jika-semisal-menggunakan-dengan">Hal ini tidak berlaku jika semisal menggunakan dengan ,</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#session-based-authentication-vs-token-based-authentication-case-session-vs-jwt">session based authentication vs token based authentication (case SESSION vs JWT)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#php-session-dan-cookie">PHP session dan cookie</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jwt">JWT</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#disable-play-video-dengan-cors">Disable play video dengan CORS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glosarium.html">Glosarium</a></li>
<li class="toctree-l1"><a class="reference internal" href="concept-program-on-linux.html">Konsep Program di Linux</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Docker and Kubernetes</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>NoteLog</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/notelog.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="notelog">
<h1>NoteLog<a class="headerlink" href="#notelog" title="Permalink to this headline">¶</a></h1>
<div class="section" id="konsep-php-nginx">
<h2>konsep php nginx<a class="headerlink" href="#konsep-php-nginx" title="Permalink to this headline">¶</a></h2>
<p>nah konsep sebenarnya php dan nginx itu gini</p>
<p>ketika ada request misal localhost:8080</p>
<p>maka dia akan diakses oleh nginx</p>
<p>lalu dibaca di server blocks nginx
kalau dapat maka dia akan diarahkan ke php dengan unix socket atau tcp
misal app:9000 (docker) atau 172.41.12.12:9000 (kalau di dalam docker)</p>
<p>so dari situ php akan memproses output nya</p>
<p>nah kalau outputnya hanyalah api (json data) maka ya output itu
tapi kalau outputnya sudah dalam html (body di dalam response) maka itu dirender pake browser
walaupun sebenarnya kalau json data juga nanti bisa saja browser merender</p>
<p>aku rasa ini juga berlaku dengan node, tapi mungkin sedikit berbeda karena di node bisa langsung write document html</p>
<p><a class="reference external" href="https://www.niagahoster.co.id/blog/web-server-adalah/">https://www.niagahoster.co.id/blog/web-server-adalah/</a>
<a class="reference external" href="https://www.niagahoster.co.id/blog/nginx-adalah/">https://www.niagahoster.co.id/blog/nginx-adalah/</a></p>
<p>makanya di docker php dia itu gak ngapa ngapain
nah sebenere koonsepnya itu dari request di browser (atau postman) lalu ke nginx dan dari config nginx akan dilanjutkan ke php (atau bisa node)
terakhir tinggal output daripada php (atau node) tersebut</p>
<p>konsep mas puji, php itu cuma menyiapkan (result) output berupa document html</p>
<p>jadi gini ketika ada akses localhost
maka nginx akan membacanya</p>
<p>kemudian dia akan menuju file php yang terletak di <cite>root</cite>/index.php (dalam hal ini /var/www/html/projects/publlic/index.php)</p>
<p>lalu php fpm akan membaca script tersebut (index.php)
mirip kayak konsep php &lt;script&gt;.php</p>
<p>tapi ini dengan adanya uri</p>
<p>lalu terakhir memunculkan result berupa element html, yang lalu dirender oleh browser</p>
<p>berbeda dengan konsep node (mern)</p>
<p>kalau mern</p>
<p>ketika ada akses localhost (misal /register)
maka server.js akan me-return api</p>
<p>lalu react akan membaca daripada routing (misal /register)
dan memunculkan komponentnya</p>
<p>artinya react dulu baru api (server.js) -&gt; yang mana seharusnya keberadaan component diatas routing di file server.js (tapi di kode gw salah)</p>
<p>nah itu sebabnya kenapa react gak ada seo
karena dia membaca dari (/)
dan menyiapkan komponennya (element html)
makanya gak kerender sama browser, tapi kerender oleh javascript (bahasa pasnya document dibuatkan oleh javascript)</p>
<p>kalau mau seo seharusnya itu kerender sama browser
lihat saja di file setup nginx</p>
<p>file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>server {
    listen 80;
    location / {
        proxy_pass http://localhost:5000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection &#39;upgrade&#39;;
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
</pre></div>
</div>
<p>gak ada root kan, artinya ketika ada akses ya langsung ke node js
nah node js ini akan melihat di index react,
component baru akan dibuatkan di suatu component tertentu</p>
<p>memang sih kalau di browser semua kelihatan
..image:: resources/images/konsep-webserver-dengan-react-1.1-result-browser.png</p>
<p>tapi kalau pake curl itu yang dapet ya cuma skeleton (kerangka) saja, nah di bagian element <code class="docutils literal notranslate"><span class="pre">&lt;div</span> <span class="pre">id=root&gt;&lt;div&gt;</span></code> itu yang nantinya akan dimasukin pake javascript
..image:: resources/images/konsep-webserver-dengan-react-1.2.result-curl.png</p>
<p>jadi seo google itu membaca isi content situs melalui element htmlnya
kalau kosong gitu ya percuma,
google belum bisa me-render pake react</p>
<p>bahkan kalau pake postman itu juga harus enable javascript
..image:: resources/images/konsep-webserver-dengan-react-1.3-result-postman.png</p>
<p>berbeda dengan php yang langsung me-render semua html element sehingga kalau pake curl pasti muncul semua</p>
<p>konsep seo google itu membaca host, lalu uri dan konten
sama halnya dengan curl atau telnet
makanya dia cerdas</p>
<p>update</p>
<p>sebagai penjelas maka coba berikut</p>
<p>file simple.js:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">http</span> <span class="o">=</span> <span class="n">require</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">),</span>
    <span class="n">PORT</span> <span class="o">=</span> <span class="mi">3400</span><span class="p">;</span>

<span class="n">var</span> <span class="n">server</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">createServer</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">){</span>
    <span class="n">var</span> <span class="n">body</span> <span class="o">=</span> <span class="s2">&quot;&lt;pre&gt;Haruskah belajar Node.js?&lt;/pre&gt;&lt;p&gt;&lt;h3&gt;...Yo Mesto!&lt;/h3&gt;&lt;/p$</span>
    <span class="n">res</span><span class="o">.</span><span class="n">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Length&#39;</span><span class="p">:</span><span class="n">body</span><span class="o">.</span><span class="n">length</span><span class="p">,</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span><span class="s1">&#39;text/html&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Pesan-Header&#39;</span><span class="p">:</span><span class="s1">&#39;Pengenalan Node.js&#39;</span>
    <span class="p">});</span>

    <span class="n">res</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">body</span><span class="p">);</span>
    <span class="n">res</span><span class="o">.</span><span class="n">end</span><span class="p">();</span>
<span class="p">});</span>

<span class="n">server</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">PORT</span><span class="p">);</span>

<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;Port &quot;</span><span class="o">+</span><span class="n">PORT</span><span class="o">+</span><span class="s2">&quot; : Node.js Server...&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>jalankan dengan node simple.js</p>
<p>hasilnya ketika dicoba dengan curl -&gt; localhost:3400</p>
<p>bagian daripada body terender</p>
<p>berbeda dengan react yang sejatinya sudah merender bagian app.js, tapi untuk element di dalam element &lt;div id=”root”&gt;  akan dibuatkan , ingat bukan di render tapi diinsert layaknya syntax append()
jika menggunakan nest</p>
</div>
<div class="section" id="konsep-api-address">
<h2>Konsep api address<a class="headerlink" href="#konsep-api-address" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.quora.com/How-do-IP-addresses-work-Does-the-IP-address-vary-from-computer-to-computer-or-does-it-depend-on-the-internet-connection-youre-using-If-I-use-my-neighbours-Wi-Fi-from-my-computer-does-that-change-my-IP-address#:~:text=This%20IP%20address%20uniquely%20identifies,is%20refreshed%20at%20specific%20intervals.&amp;text=If%20your%20wifi%20network%20has,global%20IP%20to%20your%20network">https://www.quora.com/How-do-IP-addresses-work-Does-the-IP-address-vary-from-computer-to-computer-or-does-it-depend-on-the-internet-connection-youre-using-If-I-use-my-neighbours-Wi-Fi-from-my-computer-does-that-change-my-IP-address#:~:text=This%20IP%20address%20uniquely%20identifies,is%20refreshed%20at%20specific%20intervals.&amp;text=If%20your%20wifi%20network%20has,global%20IP%20to%20your%20network</a>.</p>
<p>default gateway itu adalah ip address utama pada router yang digunakan untuk berkomuniskasi dengan remote</p>
<p>When you look at a default gateway address, e.g. 192.168.1.254 it looks like an IP address because it is an ordinary IP address. It is the IP address of the inside port on a router. This gateway router has another port connected to an internet service provider. Each host on a local area network (LAN) needs a default gateway address to communicate with hosts outside on the internet via the gateway router.</p>
<p>simplenya adalah ketika ada router maka dia ada ip host, nah yang digunakan itu default gatewanya</p>
</div>
<div class="section" id="mengapa-kalau-docker-build-harus-ada-context-path-asumsi">
<h2>mengapa kalau docker build harus ada context path (asumsi)<a class="headerlink" href="#mengapa-kalau-docker-build-harus-ada-context-path-asumsi" title="Permalink to this headline">¶</a></h2>
<p>karena ini bukanlah absolute path (path dari awal machine misal /root/docker atau /home/ryan/docker)</p>
<p>What Is An Absolute Path?
An absolute path is defined as the specifying the location of a file or directory from the root directory(/). In other words we can say absolute path is a complete path from start of actual filesystem from / directory.</p>
<p>Some examples of absolute path:
/var/ftp/pub
/etc/samba.smb.conf</p>
<p>What Is The Relative Path?
Relative path is defined as path related to the present working directory(pwd). Suppose I am located in /var/log and I want to change directory to /var/log/kernel. I can use relative path concept to change directory to kernel</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/57282805/how-to-access-docker-build-context-path-inside-dockerfile">https://stackoverflow.com/questions/57282805/how-to-access-docker-build-context-path-inside-dockerfile</a>
nah jadi katakanlah gini
dockerfile ada di</p>
<p>/home/ryan/docker/laravel/Dockerfile</p>
<p>tapi ada file di sebelum laravel, misal ada config</p>
<p>/home/ryan/docker/php.ini</p>
<p>nah itu artinya context path ini adalah root sebagai penunjuk Dockerfile</p>
<p>artinya di dalam Dockerfile bisa copy langsung file php.ini tanpa perlu harus COPY ../../php.ini</p>
<p>OK COBA ya</p>
<p>ini berlaku kalau kita pake -f untuk menyatakan dimanakah file dockerfile
<a class="reference external" href="https://docs.docker.com/engine/reference/commandline/build/#specify-a-dockerfile--f">https://docs.docker.com/engine/reference/commandline/build/#specify-a-dockerfile–f</a></p>
<p><a class="reference external" href="https://stackoverflow.com/questions/50230399/what-is-the-difference-between-docker-compose-build-and-docker-build">https://stackoverflow.com/questions/50230399/what-is-the-difference-between-docker-compose-build-and-docker-build</a></p>
<p>intinya gini daripada ada file kayak docker-commpose.yml dan Dockerfile di directory root laravel
mending disembunyiin atau maksudku letakkan saja di directory dockerconfig/
nah nanti disitu isinya nginx.conf, my.cnf, php-fpm.ini tapi di direktori yang berbeda beda
lebih enak kan</p>
<p>btw gw lebih percaya sih context path itu bagaikan directory path
nah file docker gak usahlah kasih secara jelas, langsung saja dockerfile</p>
<p>lagian kan docker-compose itu secara default akan baca .env di same directory bahaya lah kalau gini caranya</p>
</div>
<div class="section" id="mengapa-di-mysql-official-harus-memberikan-adanya-p">
<h2>Mengapa di mysql official harus memberikan adanya -p<a class="headerlink" href="#mengapa-di-mysql-official-harus-memberikan-adanya-p" title="Permalink to this headline">¶</a></h2>
<p>pertanyaannya kenapa harus memberikan -p 3306:3306
padahal kan di dockerfile sendiri sudah expose
aneh kan ya</p>
<p>nah ini jawabnya</p>
<p>initanpa memberikan -p
docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                 NAMES
8c0608259965        mysql:latest        “docker-entrypoint.s…”   7 seconds ago       Up 6 seconds        3306/tcp, 33060/tcp   crazy_kepler</p>
<p>ini dengan memberikan -p
docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                               NAMES
bd676a579150        mysql:latest        “docker-entrypoint.s…”   16 seconds ago      Up 16 seconds       0.0.0.0:3306-&gt;3306/tcp, 33060/tcp   determined_bohr</p>
<p>perbedaannya adalah dengan -p maka ada host</p>
<p>nah ni juga berlaku pada nginx
tapi kalau sudah ada nginx di local (host) ya gak bisa -p 80:80
untuk me list port yang lagi di listen
sudo lsof -i -P -n | grep LISTEN</p>
<p>jadi intinya kalau gak dikasih -p gak bakal tau dia listen dimana
cek aja pake docker ps di bagian ports atau
sudo lsof -i -P -n | grep LISTEN</p>
<p>dia listen gak</p>
<p>atau bisa juga pake ping ke container lain
seperti mas puji dullu</p>
<p>artinya apa expose di dockerfile itu cuma buat aja available di ports (docker ps)
tapi implementasinya ya di -p</p>
<p>kalau misal pake -P (P besar) itu akan memberikan random port</p>
</div>
<div class="section" id="mengapa-di-docker-php-image-pake-docker-php-ext-install">
<h2>mengapa di docker php image pake docker-php-ext-install<a class="headerlink" href="#mengapa-di-docker-php-image-pake-docker-php-ext-install" title="Permalink to this headline">¶</a></h2>
<p>kenapa di image php
lebih menggunakna docker-php-ext-install ?
misal docker-php-ext-install pdo_mysql</p>
<p>karena ternyata librarty pdo_mysql ini adalah dia akan mendownload segala macem file shingga image jadi besar
selain itu dia juga akan meng-commpile
compilenya itu belum tentu dipake
ini juga makin membuat lama dalam build image
makanya scriptnya mas puji agak lama</p>
</div>
<div class="section" id="melihat-history-log-di-linux">
<h2>Melihat history log di linux<a class="headerlink" href="#melihat-history-log-di-linux" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://servernesia.com/2321/melihat-riwayat-perintah-linux/">https://servernesia.com/2321/melihat-riwayat-perintah-linux/</a></p>
</div>
<div class="section" id="redirection">
<h2>redirection<a class="headerlink" href="#redirection" title="Permalink to this headline">¶</a></h2>
<p>ok done, jadi redirection (&lt;, &lt;&lt; atau &gt;, &gt;&gt;) itu hanya membaca file log (stream text)
me-redirect atau memindahkan output atau input program.
Misalnya, program yang outputnya ke stdout atau ke terminal bisa diredirect atau dipindahkan ke file, output dari stderr diredirect ke stdout, dan sebagainya.</p>
<p>Karakter &gt; untuk redirect output.
Karakter &lt; untuk redirect input.</p>
<p>cat /etc/passwd | grep “nobody” &gt; ~/user.txt</p>
<p>jadi buat tar gak bisa kalau docker exec</p>
<p>sebenarnya docker exec adalah mengeksekusi di dalam container</p>
</div>
<div class="section" id="cara-membuat-web-application-nginx-dengan-subdirectory">
<h2>cara membuat web application (nginx) dengan subdirectory<a class="headerlink" href="#cara-membuat-web-application-nginx-dengan-subdirectory" title="Permalink to this headline">¶</a></h2>
<p>jadi kalau
domain/&lt;uri1&gt;
biasanya kan uri1 itu gak bisa jadi applicaition
paling kalau gak folder ya jadi api</p>
<p><a class="reference external" href="https://serversforhackers.com/c/nginx-php-in-subdirectory">https://serversforhackers.com/c/nginx-php-in-subdirectory</a>
dibanding membuat dengan domain
aku rasa ada bagusnya dengan subdirectory</p>
</div>
<div class="section" id="ubuntu-vs-centos">
<h2>ubuntu vs centos<a class="headerlink" href="#ubuntu-vs-centos" title="Permalink to this headline">¶</a></h2>
<p>enaknya di centos itu lifetime lTS cukup panjang yaitu 10 tahun
artinya gak banyak update2</p>
<p>bandingkan dengan ubuntu yang mungkin cuma 2 tahun saja</p>
<p>masalah lain kalau ada perubahan package yang begitu cepat, lantas apa resourcenya itu sudah ada</p>
<p>kek misal di ubuntu desktop gw (16.04), baru gw pake 2 tahun
pas
sudo apt-get update</p>
<p>eh malah error, kan kesel ye</p>
</div>
<div class="section" id="ubuntu-vs-centos-berani-pakai-centos">
<h2>ubuntu vs centos, berani pakai centos ?<a class="headerlink" href="#ubuntu-vs-centos-berani-pakai-centos" title="Permalink to this headline">¶</a></h2>
<p>bedanya apt sama yum
jadi itu adalah package manage
apt untuk ubuntu
dan yum untuk red hat
kenapa beda ?
karena ya memang beda bro
jadi katakanlah di apt itu repositorynya lebih banyak dibanding yum yang mungkin untuk urusan server</p>
<p>selain itu perbedaan ubuntu dan red hat pada sisi direktori juga akan memiliki metode tersendiri dalam menaruh file
makanya dibedakan reponya
tapi menurutku sih gak jauh jauh amat ya perbedaannya
artinya tiap software gui bisalah diinstall</p>
<p>jadi perbedaan antara ubuntu desktop dan rhel itu cuma repository di apt dan yum
dimana</p>
<p>selain itu update ubuntu itu terlalu cepat
sehingga tidak cocok untuk server
berbeda dengan centos yang memberikan waktu hingga 5 tahun sampai rilis terbarunya</p>
<p>ini akan mempengaruhi di repository
contoh kasus adalah misal menginstall package php atau node</p>
<p>misal di ubuntu 14 masih node versi 4
sedangkan di ubuntu 18 sudah versi 10
ya jelas berbeda</p>
<p>masak iya tiap package download sendiri, terus build (compile ke binary)
kan repot
sehingga inilah yang menjadikan distro arch linux lebih disukai, karena repository nya (pacman) selalu menyediakan yang terupdate</p>
</div>
<div class="section" id="network-0-0-0-0">
<h2>network 0.0.0.0<a class="headerlink" href="#network-0-0-0-0" title="Permalink to this headline">¶</a></h2>
<p>ok ini diluar docker
tapi sebenarnya network itu gimana sih</p>
<p>gampangnya gini 0.0.0.0 itu artinya bisa diakses oleh semuanya</p>
<p>nah laptop itu pasti ada 127.0.0.1 dan kalau ada wifi pasti 192.168.x.x</p>
<p>misalkan ada software (mysql) nah dia <cite>secara default</cite> hanya bisa listen 127.0.0.1 dengan port 3306</p>
<p>bisa saja di mysql kita buat 0.0.0.0 artinya siapapun bisa akses dia (apalagi laptop local yang pake 127.0.0.1)</p>
<p>ini juga berlaku pada service lain
misal node,</p>
<p>makanya perlu diberikan host
nah kalau 127.0.0.1 itu berarti local laptop (biasa disebut di localhost)</p>
<p>localhost ini apa ? nama aja, jadi itu dns ngubah ke 127.0.0.1</p>
</div>
<div class="section" id="volume-itu-akan-menghapus">
<h2>volume itu akan menghapus<a class="headerlink" href="#volume-itu-akan-menghapus" title="Permalink to this headline">¶</a></h2>
<p>misal pada Dockerfile telah melakukan git clone atau memberikan file (ADD atau COPY)</p>
<p>tapi dilakukan mounting
docker run –rm -v &lt;path-host&gt;:&lt;path-container&gt;</p>
<p>misal di path-host itu kosong, sedangkan path-container itu telah diberikan file (entah dari git clone atau ADD/COPY)
nah pas mounting bakal kosong</p>
<p>kalau saat build ya ada file (dari git clone atau add/copy)
tapi kalau di mounting ya hilang juga</p>
</div>
<div class="section" id="konsep-node-php-dan-service-backend">
<h2>konsep node,php dan service backend<a class="headerlink" href="#konsep-node-php-dan-service-backend" title="Permalink to this headline">¶</a></h2>
<p>jadi sebenarnya dari nginx itu sendiri adalah</p>
<dl>
<dt>server {</dt><dd><p>listen 80 default_server;
listen [::]:80 default_server;</p>
<p>root /var/www/html;
index index.php index.html index.htm index.nginx-debian.html;</p>
<p>server_name server_domain_or_IP;</p>
<dl class="simple">
<dt>location / {</dt><dd><p>try_files $uri $uri/ =404;</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>location ~ .php$ {</dt><dd><p>include snippets/fastcgi-php.conf;
fastcgi_pass localhost:9000;</p>
</dd>
</dl>
<p>}</p>
<dl class="simple">
<dt>location ~ /.ht {</dt><dd><p>deny all;</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
<p>}</p>
<p>nah servicenya php itu jalan dimana
jadi php itu adlah service yang berjalan di port 9000</p>
<p>nah contoah lain adalah node</p>
<dl>
<dt>server {</dt><dd><p>listen 80;
location / {</p>
<blockquote>
<div><p>proxy_pass <a class="reference external" href="http://localhost:5000">http://localhost:5000</a>;
proxy_http_version 1.1;
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection ‘upgrade’;
proxy_set_header Host $host;
proxy_cache_bypass $http_upgrade;</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>}</p>
<p>jadi sebenarnya ketika akses
domain.com/</p>
<p>itu dia akan diterimma oleh nginx, karena nginx listen di 80 (port default web)
kemudian ketika di root /, maka dia akan dilempar ke service localhost:5000
dimana kebetulan node jalan di localhost:5000 (dijalankan di localhsot:5000)</p>
<p>nah service kayak php, node itu jalan di tcp/ip</p>
<p>kalau php mah ada opsi fpm unix socket, tapi gak bisa karena untuk konsep docker container akan error</p>
<p>nah ciri2nya gimana</p>
<p>misal nih</p>
<p>di local</p>
<p>kan akses localhsot:5000 sama localhost
kok yang localhost:5000 itu node kalau di localhost itu nginx html</p>
<p>karena ya gitu</p>
<p>namanya juga tcp/ip</p>
<p>artinya bisa diakses</p>
<p>misal
curl localhost:5000 sama curl localhost</p>
<p>ya hasilnya sama, yg 5000 ke node yang</p>
<p>jadi jangan tanya</p>
<p>tcp/ip itu adalah standard</p>
<p>intinya gini nginx itu service yang paling jalan/cuma listen di 80 (tcp/ip 80)</p>
<p>nah sisanya service lain yang mau mendengarkan di tcp/ip port berapa</p>
<p>kalau gak ada service nginx
<a class="reference external" href="mailto:intel&#37;&#52;&#48;intel-Satellite-C55t-C">intel<span>&#64;</span>intel-Satellite-C55t-C</a>:~$ curl localhost
curl: (7) Failed to connect to localhost port 80: Connection refused
<a class="reference external" href="mailto:intel&#37;&#52;&#48;intel-Satellite-C55t-C">intel<span>&#64;</span>intel-Satellite-C55t-C</a>:~$</p>
<p>karena yang listen di 80 gak ada</p>
</div>
<div class="section" id="perbedaan-binary-dan-source-code">
<h2>Perbedaan binary dan source code<a class="headerlink" href="#perbedaan-binary-dan-source-code" title="Permalink to this headline">¶</a></h2>
<p>kalau binary itu executable</p>
<p>kaalu source code
itu biasanya pake:
-&gt; configure
-&gt; make
-&gt; make install</p>
<p>sederhananya dia itu meng copy file ke local langsung (pake command kek cp)</p>
<p>nah secara umum ada 3 proses</p>
<ol class="arabic simple">
<li><p>configure</p></li>
</ol>
<p>biasanya configure itu kayak cek apakah sudah ada depedency yang dibutuhkan
kalau gak ada bakal error</p>
<p>misal machine pake architecture apa
ada directory /sbin gak, (kalau bukan linux umum seperti debian biasanya gagal)</p>
<ol class="arabic simple" start="2">
<li><p>make</p></li>
</ol>
<p>sebenarnya ini membaca file Makefile secara default</p>
<p>nah defaultnya biasanya adalah build</p>
<p>atau katakanlah dia itu menjalankan command <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">build</span></code></p>
<p>make build ini adalah proses compile
nah proses build ini biasanya akan menjalankan function function
seperti regular express dll
proses ini dinamakan compile (membuat source code ke binary)
biasanya file objective c (.c) atau python (.py) -&gt; makanya sering disebut bahasa mesin (machine) nah kudu di compile dulu kan biar jalan
nah dari sini file yang dihasilkan itu encrypted, artinya ya gak bisa dilihat
misal cat {nama-file-src}
ya hasilnya aneh begini</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>T�▒��
                        symtab.strt
</pre></div>
</div>
<p>tapi itu biasanya disimpan di directory sementar
3. make install</p>
<p>nah biasanya ini baru copy dari directory smeentara ke yang aslinya</p>
<p>itulah kenapa program bakal aman, karena sudah encrypted</p>
<p>ok jadi dari sini sudah diketahui ya bagaimana mendapatkan directory hasil compile (binary)
artinya jangan jalanin install
di nginx
install:        build</p>
<blockquote>
<div><p>test -d ‘$(DESTDIR)/usr/local/nginx’ || mkdir -p ‘$(DESTDIR)/usr/local/nginx’</p>
<dl class="simple">
<dt>test -d ‘$(DESTDIR)/usr/local/nginx/sbin’ </dt><dd><p>|| mkdir -p ‘$(DESTDIR)/usr/local/nginx/sbin’</p>
</dd>
</dl>
<p>test ! -f ‘$(DESTDIR)/usr/local/nginx/sbin/nginx’ </p>
</div></blockquote>
<p>build:  binary modules manpage</p>
<p>binary: objs/nginx</p>
<dl>
<dt>objs/nginx:     objs/src/core/nginx.o </dt><dd><p>objs/src/core/ngx_log.o objs/src/core/ngx_palloc.o objs/src/core/ngx_array.o objs/src/core/ngx_list.o …</p>
<p>$(LINK) -o objs/nginx objs/src/core/nginx.o objs/src/core/ngx_log.o objs/src/core/ngx_palloc.o objs/src/core/ngx_array.o objs/src/core/ngx_list.o objs/src/core/ngx_hash.o …</p>
</dd>
</dl>
<p>modules:</p>
<dl>
<dt>objs/ngx_modules.o:     $(CORE_DEPS) </dt><dd><p>objs/ngx_modules.c
$(CC) -c $(CFLAGS) $(CORE_INCS) </p>
<blockquote>
<div><p>-o objs/ngx_modules.o objs/ngx_modules.c</p>
</div></blockquote>
</dd>
</dl>
<p>manpage:        objs/nginx.8</p>
<dl class="simple">
<dt>objs/nginx.8:   man/nginx.8 objs/ngx_auto_config.h</dt><dd><dl class="simple">
<dt>sed -e “s|%%PREFIX%%|/usr/local/nginx|” </dt><dd><p>-e “s|%%PID_PATH%%|/usr/local/nginx/logs/nginx.pid|” -e “s|%%CONF_PATH%%|/usr/local/nginx/conf/nginx.conf|” -e “s|%%ERROR_LOG_PATH%%|/usr/local/nginx/logs/error.log|” &lt; man/nginx.8 &gt; $&#64;</p>
</dd>
</dl>
</dd>
</dl>
<p>jadi maksudnya kalau make
dia itu artinya make build
nah build ini menjalankan 3 alur -&gt; 1 binary, 2 modules, 3 manpage</p>
<p>nah alur binary dia itu menjalankan alur objs/nginx, dimana ini adalah link ke directory sementara objs</p>
<p>nah alur module itu lah yang membuat compile</p>
<p>terakhir si manpage cuma membuat adanya replace (regex), cmiiw</p>
<p>nah biasanya yang bikin error itu karena gak ada tool buat compiling, entah g++, compiler c, dll</p>
<p>contoh
<a class="reference external" href="https://itsfoss.com/install-software-from-source-code/">https://itsfoss.com/install-software-from-source-code/</a></p>
<p>makanya pastiin aja udah benar,
dan satu lagi jangan lupa</p>
<p>note:: ada juga yang menggunakan build system selain make, yaitu ninja, tapi ini kurang recommended (contoh <a class="reference external" href="https://github.com/phw/peek">https://github.com/phw/peek</a>)</p>
<p>tapi beberapa kayak redis biasanya gak ada configure, dia malah langsung make dan make install</p>
<p>kalau apt-get itu malah kayak binary</p>
<p>kalau binary itu adalah file executable
nah ini enak tinggal execute saja</p>
<p>biasanya kalau download binary itu ada pilihan, antara arm64 atau 64bit (amd64)
sebenarnya itu adalah hasil daripada install source code</p>
<p>jadi katakanlah dari source code itu bisa me-detect processor machine, apakah pake arm64 atau amd64</p>
<p>nah ini juga lah yang mengakibatkan perbedaan antara linux dan macos
karena machine pada macos itu beda banget</p>
<p>makanya ada software macos yang gak bisa jalan di linux misal sequel pro
artinya dia khusus di desain untuk machine macos (gak buat build untuk arm64 atau amd64)
kenapa ?
singkatnya karena dia ditulis dengan objective-c
yang khusus untuk machine macos</p>
<p>nah istilah commpile itu adalah membuat encrypted tersebut</p>
<p>sedangkan perbedaan 32 bit dan 64 bit hanya terletak pada penggunaan ram
misal 64bit jauh lebih cepat</p>
</div>
<div class="section" id="apa-itu-alpine">
<h2>apa itu alpine<a class="headerlink" href="#apa-itu-alpine" title="Permalink to this headline">¶</a></h2>
<p>Alpine is a busybox-based linux distribution on steroids: it is gaining so much traction in the Docker ecosystem since it has 2 features that, combined together, make it quite of a valuable base image: it is ~5mb in size and uses the apk package manager.</p>
<p>nah kalau misal mau tahu menginstalll package lewat alpine
<a class="reference external" href="https://github.com/nodejs/docker-node/blob/master/14/alpine3.12/Dockerfile">https://github.com/nodejs/docker-node/blob/master/14/alpine3.12/Dockerfile</a></p>
<p>jadi intinya dari alpine sudah ada repository, tapi ini khusus untuk membuat compile, seperti g++</p>
<p>nah jadi busybox itu awal banget
dibawahnya ada alpine yang menjadi linux</p>
<p>nah alpine ini ada beberapa tipe macchine juga
misal alpine 3.12 itu untuk x86_64 atau amd64
jadi ya gak mesti</p>
<p>lihat saja di docker node js, ada</p>
<p>bashbrew-arch   variants
amd64    stretch,stretch-slim,buster,buster-slim,alpine3.10,alpine3.11,alpine3.12
arm32v6  alpine3.10,alpine3.11,alpine3.12
arm32v7  stretch,stretch-slim,buster,buster-slim,alpine3.10,alpine3.11,alpine3.12
arm64v8  stretch,stretch-slim,buster,buster-slim,alpine3.10,alpine3.11,alpine3.12
i386     alpine3.10,alpine3.11,alpine3.12
ppc64le  stretch,stretch-slim,buster,buster-slim,alpine3.10,alpine3.11,alpine3.12
s390x    stretch,stretch-slim,buster,buster-slim,alpine3.10,alpine3.11,alpine3.12</p>
<p>biasanya yang i386 (32bit) itu ngikutnya amd64</p>
<p>x86 Based
- x86 - 32 bit x86 (ia32)
- x86_64 - 64 bit x86 (amd64)
ARM Based
- armhf - 32 bit ARM (hard-float ABI) - ARMv6
- armv7 - 32 bit ARMv7
- aarch64 - 64 bit ARM - ARMv8
PowerPC Based
- ppc64le - 64 bit PowerPC (little-endian)
IBM System Z Based
- s390x</p>
<p>yang jelas amd64 dan arm itu lebih lengkap, karena hampir semua versi alpine ada</p>
<p>untuk run alpine pertama kali</p>
<p>apk update &amp;&amp; apk add ca-certificates</p>
<p>jadi ada cara juga
misal install git di alpine kan
terus commit di awal
abis itu install node
nah bisa dilihat hasil build</p>
</div>
<div class="section" id="kalau-serius-mau-buat-dockerfile">
<h2>kalau serius mau buat dockerfile<a class="headerlink" href="#kalau-serius-mau-buat-dockerfile" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://hub.docker.com/r/readthedocs/build/dockerfile">https://hub.docker.com/r/readthedocs/build/dockerfile</a></p>
</div>
<div class="section" id="docker-push-new-repo">
<h2>docker push new repo<a class="headerlink" href="#docker-push-new-repo" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>buat repo di docker hub (public/private)</p></li>
<li><p>di local pastikan sudah build, dengan catatan pastikan di local bukan latest</p></li>
<li><p>buat tag</p>
<blockquote>
<div><div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>docker tag &lt;local-repo&gt;:<span class="nt">&lt;tag-local-repo-saat-ini&gt;</span> &lt;remote-repo&gt;:latest
atau
docker tag &lt;local-repo&gt;:<span class="nt">&lt;tag-local-repo-saat-ini&gt;</span> &lt;remote-repo&gt;
</pre></div>
</div>
<p>misal remote repo adalah ryanasnan/sphinxrtd</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span># build image di local dengan tag awal
docker build -t sphinxrtd:1.0 .
# buat tag dari image local tersebut dimana tag nya ini adalah {remote-repo}:latest
docker tag sphinxrtd:1.0 ryanasnan/sphinxrtd:latest
# push ke remote repo dengan tag tersebut -&gt; {remote-repo}:latest
docker push ryanasnan/sphinxrtd:latest
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>siklus selanjutnya</p>
<blockquote>
<div><p>ketika adanya perubahan di Dockerfile, ulangi tapi dengan catatan ini masuk ke tag selanjutnya</p>
<p>misal</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>docker build -t sphinxrtd:2.0 .
docker tag sphinxrtd:2.0 ryanasnan/sphinxrtd:latest
docker push ryanasnan/sphinxrtd:latest
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>setelah push akan muncul image baru dengan tag tersebut,
sebenarnya itu adalah hasil tagging, jadi dihapus saja</p>
<p>docker image rm &lt;nama-tag-image&gt;:&lt;tag-image&gt;
misal
docker image rm ryanasnan/sphinxrtd:latest</p>
</div>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="docker-compose-restart-always-on-autostart">
<h2>docker compose restart always (on autostart)<a class="headerlink" href="#docker-compose-restart-always-on-autostart" title="Permalink to this headline">¶</a></h2>
<p>Today I had the same issue that all containers are started when I boot my dev laptop, as restart: always was set in the .yml files.</p>
<p>As I don’t want to touch the .yml files, I just found out (thx Bobby) how to alter this setting by:</p>
<p>docker update –restart=no &lt;MY-CONTAINER-ID&gt;</p>
<p>jadi pada dasarnya ketika di <cite>docker-compose</cite> memiliki restart always, maka ketika machine di restart, ini akan run secara otomatis</p>
<p>solusinya hanya satu yaitu mematikan</p>
<p>cara lain mungkin menghapus container (running image), tapi ini kurang disarankan, karena kalau misal statefull, artinya data2 akan hilang</p>
<p>jadi ya sudah gak apa apa tiap restart bakal running otomatis</p>
<div class="section" id="menghilangkan-dengan-docker-compose-down">
<h3>menghilangkan dengan docker-compose down<a class="headerlink" href="#menghilangkan-dengan-docker-compose-down" title="Permalink to this headline">¶</a></h3>
<p>jika semisal masih running ketika di restart, maka bisa saja menggunakan docker-compose down</p>
<p>namun perlu diketahui bahwa docker-compose down akan menghapus container, sehingga ini sebabnya kalau docker-compose up akan memulai lagi membuat container</p>
<p>namun kalau semisal container bersifat statefull dan statefullnya disimpan di volume (terutama volume di local machine) tentu akan aman aman saja</p>
<p>walaupun ya kurang diketahui juga sih</p>
<p>tapi kayaknya aman2 saja</p>
<p>so, kalau berhentiin docker-compose baiknya pake docker-compose down saja sih (jangan ctrl + c)</p>
</div>
</div>
<div class="section" id="penjelasan-host">
<h2>penjelasan host<a class="headerlink" href="#penjelasan-host" title="Permalink to this headline">¶</a></h2>
<p>jadi sebenere /etc/hosts itu hanya pembuat saja</p>
<p>misalkan saja pake dnsmasq
dibuat
address=/.laravel/127.0.0.1
address=/.menorah/127.0.0.1</p>
<p>artinya semua yang berakhiran dengan .laravel atau .menorah akan menuju 127.0.0.1</p>
<p>misal
sequla.laravel
project.menorah
dst</p>
<p>sebenarnya itu hanya akan menuju 127.0.0.1</p>
<p>nah dari nginx sebenarnya bisa mengetahui nama server
nginx.conf
server_name</p>
<p>tapi kalau semisal gak didaftarkan di hosts ya tentu saja gak bisa
karena itu artinya gak ada forward ke 127.0.0.1</p>
<p>jadi katakanlah hostname (/etc/hosts) itu akan diterima di server_name di nginx.conf
tapi kalau belum ada penentuan di /etc/hosts ya itu gak bisa</p>
</div>
<div class="section" id="masalah-php-dan-nginx-di-docker">
<h2>masalah php dan nginx di docker<a class="headerlink" href="#masalah-php-dan-nginx-di-docker" title="Permalink to this headline">¶</a></h2>
<p>jika bukan laravel (hanya php dan nginx saja)
, apakah benar bahwa resource project itu diletakkan di php service
kalau misal dikasih di nginx service dan di php service dihilangkan bagaimana ?
dan ternyata benar, memang bacanya di php bukan di nginx service
jadi project (php, node, dll) itu gak perlu di berikan di nginx melainkan di service server tersebut (php, node, dll)</p>
<p>tapi jika laravel</p>
<p>itu directory laravel harus di attach di nginx (i dont know why)
kalau gak bakal error
kalau dihilangkan di nginx service muncul 404 not found
kalau dihilangkan di php service muncul error file not found (bukan 404)</p>
</div>
<div class="section" id="docker-compose-adalah-seperti-halnya-docker-run">
<h2>docker-compose adalah seperti halnya docker run<a class="headerlink" href="#docker-compose-adalah-seperti-halnya-docker-run" title="Permalink to this headline">¶</a></h2>
<p>service di docker-compose mirip dengan docker run</p>
<p>A service definition contains configuration that is applied to each container started for that service, much like passing command-line parameters to docker run. Likewise, network and volume definitions are analogous to docker network create and docker volume create.</p>
<p>As with docker run, options specified in the Dockerfile, such as CMD, EXPOSE, VOLUME, ENV, are respected by default - you don’t need to specify them again in docker-compose.yml.</p>
<p>service di docker compose bertujuan untuk menciptakan lebih dari 1 container dalam 1 service
<a class="reference external" href="https://stackoverflow.com/questions/35565770/difference-between-service-and-container-in-docker-compose#:~:text=Services%20and%20container%20are%20related,compose%20you%20can%20handle%20services.&amp;text=Additionally%2C%20with%20docker%2Dcompose%20you,against%20one%20or%20more%20services">https://stackoverflow.com/questions/35565770/difference-between-service-and-container-in-docker-compose#:~:text=Services%20and%20container%20are%20related,compose%20you%20can%20handle%20services.&amp;text=Additionally%2C%20with%20docker%2Dcompose%20you,against%20one%20or%20more%20services</a>.</p>
<p>yang bagian build/image seperti halnya build/image
yang bagian port adalah -p
yang bagian network adalah –network
yang bagian volume adalah -v</p>
</div>
<div class="section" id="jika-ingin-mount-volume-pastikan-file-yang-di-mount-bener-semua-terkadang-kalau-ada-dockerfile-bikin-error-saja">
<h2>jika ingin mount volume pastikan file yang di mount bener semua, terkadang kalau ada Dockerfile bikin error saja<a class="headerlink" href="#jika-ingin-mount-volume-pastikan-file-yang-di-mount-bener-semua-terkadang-kalau-ada-dockerfile-bikin-error-saja" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="jika-pas-di-docker-compose-up-itu-terkadang-ada-tambahan-misal-php-1-atau-web-1-nah-itu-juga-bisa-dijadikan-server-tersendiri-bisa-untuk-php-1-9000-pada-nginx">
<h2>jika pas di docker compose up itu terkadang ada tambahan, misal php_1 atau web_1 nah itu juga bisa dijadikan server tersendiri (bisa untuk php_1:9000 pada nginx)<a class="headerlink" href="#jika-pas-di-docker-compose-up-itu-terkadang-ada-tambahan-misal-php-1-atau-web-1-nah-itu-juga-bisa-dijadikan-server-tersendiri-bisa-untuk-php-1-9000-pada-nginx" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="php-extension-in-docker">
<h2>php extension in docker<a class="headerlink" href="#php-extension-in-docker" title="Permalink to this headline">¶</a></h2>
<p>php extension (php-gd dan lainnya)</p>
<p><a class="reference external" href="https://gist.github.com/chronon/95911d21928cff786e306c23e7d1d3f3">https://gist.github.com/chronon/95911d21928cff786e306c23e7d1d3f3</a></p>
<div class="section" id="gak-perlu-install-package-aneh-aneh">
<h3>gak perlu install package aneh aneh<a class="headerlink" href="#gak-perlu-install-package-aneh-aneh" title="Permalink to this headline">¶</a></h3>
<p>di bagian dockerfile yang lain terdapat adanya banyak package seperti g++, c dll</p>
<p>nah untuk mengcompile maka butuh adanya build essential
build essential
The build-essential package is a reference for all the packages needed to compile a Debian package. It generally includes the GCC/g++ compilers and libraries and some other utilities.</p>
<p>menurutku sih gak perlu sampai install itu semua</p>
</div>
</div>
<div class="section" id="cors-dan-implementasi-proxy-di-react">
<h2>CORS dan Implementasi Proxy di React<a class="headerlink" href="#cors-dan-implementasi-proxy-di-react" title="Permalink to this headline">¶</a></h2>
<div class="section" id="cors-cross-origin-resource-sharing">
<h3>CORS (Cross Origin Resource Sharing)<a class="headerlink" href="#cors-cross-origin-resource-sharing" title="Permalink to this headline">¶</a></h3>
<p>CORS adalah penggunaan resource yang berasal dari <strong>luar</strong> origin (di luar <cite>current host</cite>).</p>
<p>Contoh termudah adalah semisal seperti gambar berikut</p>
<img alt="_images/CORS-1.1.principle.png" src="_images/CORS-1.1.principle.png" />
<p>Pada gambar diatas untuk mendapatkan gambar (tag &lt;img&gt;), maka perlu mengakses <code class="docutils literal notranslate"><span class="pre">domain-b.com</span></code> (request GET)</p>
<p>CORS ini hanya berlaku pada <cite>modern</cite> browser, dimana terdapat adanya akses ke suatu situs menggunakan web application (browser) melalui suatu <code class="docutils literal notranslate"><span class="pre">origin</span></code>.</p>
<p>CORS bertujuan untuk dapat saling berbagi content antar web app, seperti misal <code class="docutils literal notranslate"><span class="pre">images</span></code>, <code class="docutils literal notranslate"><span class="pre">css</span></code> atau bahkan suatu <code class="docutils literal notranslate"><span class="pre">script</span></code> yang mana kesemuanya akan memberikan adanya <cite>path source</cite> dimanakah content itu berasal.</p>
<p>Berikut contoh termudah dalam penggunaan CORS</p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;https://wallpapercave.com/wp/wp2705709.jpg&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">link</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.css&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.js&quot;</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.js&quot;</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Di atas adalah contoh penggunaan CORS untuk memberikan content berupa <cite>image</cite>, <cite>css</cite> dan <cite>script</cite> yang berasal dari luar, inilah yang disebut sebagai <code class="docutils literal notranslate"><span class="pre">Cross-Origin</span> <span class="pre">Resource</span> <span class="pre">Sharing</span></code>.</p>
<p>Sedangkan akses seperti <code class="docutils literal notranslate"><span class="pre">curl</span></code> atau <code class="docutils literal notranslate"><span class="pre">wget</span></code> tidak akan dianggap sebagai CORS, karena tidak menggunakan media browser (melainkan terminal).</p>
<p>Penjelasan lebih lanjut tentang CORS akan dibahas pada tulisan dibawah.</p>
<div class="section" id="origin">
<h4>Origin<a class="headerlink" href="#origin" title="Permalink to this headline">¶</a></h4>
<p>Apa itu Origin ???</p>
<p>Secara garis besar origin adalah suatu <cite>host</cite>, <cite>scheme</cite> atau <cite>port</cite> pada URL yang digunakan dalam mengakses resource dari server sendiri.</p>
<p>misal saat mengakses <cite>www.detik.com</cite> di browser, lalu didalamnya akan memuat data-data seperti berita dan lain lain.</p>
<p>Data data tersebut sejatinya diakses dari dalam backend server <cite>www.detik.com</cite> itu sendiri, maka karenanya <cite>www.detik.com</cite> akan disebut sebagai <code class="docutils literal notranslate"><span class="pre">origin</span></code> disini.</p>
<p>Apapun request yang mana masih berada dalam <cite>www.detik.com</cite> maka akan dinamakan sebagai <cite>same-origin</cite>, seperti misal <cite>www.detik.com/sport</cite> akan dianggap masih dalam <cite>same origin</cite>.</p>
<p>Namun jika semisal terdapat suatu situs seperti <cite>www.kompas.com</cite> yang mana data di dalamnya berasal daripada <cite>www.detik.com</cite> (melalui ajax/XHR) maka pengaksesan content tersebut dikatakan sebagai <code class="docutils literal notranslate"><span class="pre">cross-origin</span> <span class="pre">resource</span> <span class="pre">sharing</span></code> (CORS).</p>
<p>Atau bisa dikatakan content daripada <code class="docutils literal notranslate"><span class="pre">www.kompas.com</span></code> berasal dari <cite>www.detik.com</cite>, disini maka www.kompas.com akan disebut menggunakan teknologi <code class="docutils literal notranslate"><span class="pre">CORS</span></code>.</p>
<p>Suatu web application dikatakan menggunakan <cite>HTTP cross-origin</cite> jika saat request resource menggunakan origin yang berbeda (domain, protocol, atau port) dari dirinya.</p>
<p>Berikut contoh cross-origin:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">app1</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">app2</span>
</pre></div>
</div>
<p>Dimana contoh diatas masuk kedalam <cite>different schemes</cite> (lihat adanya penggunaan <code class="docutils literal notranslate"><span class="pre">http</span></code> dengan <code class="docutils literal notranslate"><span class="pre">https</span></code>)</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Saat membuka chrome, maka dari console bisa langsung melakukan akses resource luar dengan menggunakan method <cite>fetch</cite> dari console.</p>
<p>Seperti misal di situs www.detik.com lalu membuka console dan mengetikkan:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fetch</span><span class="p">(</span><span class="s2">&quot;www.google.com&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Saat dijalankan maka itu sama saja akan mengakses host lain yaitu <cite>www.google.com</cite> melalui host <cite>www.detik.com</cite> dari consolenya (cross-origin).</p>
<p>Namun tentunya ini akan menimbulkan <cite>error</cite> karena adanya ‘same-origin’ policy yang akan dibahas pada tulisan dibawah.</p>
</div>
</div>
<div class="section" id="same-origin-policy-dalam-cors">
<h4><cite>Same-Origin policy</cite> dalam CORS<a class="headerlink" href="#same-origin-policy-dalam-cors" title="Permalink to this headline">¶</a></h4>
<p>Sayangnya dalam browser modern terdapat adanya aturan bernama <cite>same-origin policy</cite>.</p>
<p>Yang mana secara mudahnya bahwa browser, untuk alasan <cite>security</cite> akan membatasi request yang tidak berasal dari host <cite>same origin</cite> yang diakses melalui browser.</p>
<p>Mengapa browser menerapkan adanya <cite>same-origin policy</cite> ???</p>
<p>Contoh termudah adalah sebagai berikut:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">User</span> <span class="pre">a</span></code> Masuk ke situs <code class="docutils literal notranslate"><span class="pre">www.bankabc.com</span></code></p></li>
<li><p>Kemudian melakukan login ke dalam situs tersebut.</p></li>
<li><p>Setelah proses login berhasil, maka selanjutnya akan terdapat penyimpanan <cite>cookie</cite> di client (dan mungkin session di server), cookie disini akan digunakan dalam pengaksesan yang membutuhkan <code class="docutils literal notranslate"><span class="pre">authorization</span></code> di <cite>wwww.bankabc.com</cite>, seperti misal saat mengakses halaman <cite>www.bankabc.com/profile</cite>, <cite>www.bankabc.com/mutation</cite> atau mungkin untuk melakukan transfer dll, maka client hanya perlu memberikan adanya cookie tadi.</p></li>
<li><p>Lalu user melanjutkan browsing dan membuka beberapa situs lain, <code class="docutils literal notranslate"><span class="pre">semisal</span> <span class="pre">www.situslain.com</span></code></p></li>
<li><p>Dan ternyata pada <code class="docutils literal notranslate"><span class="pre">www.situslain.com</span></code> terdapat code dimana dia mengakses <code class="docutils literal notranslate"><span class="pre">www.bankabc.com/profile</span></code></p></li>
<li><p>Tentu saja karena masih terdapat adanya cookie yang disimpan, maka ketika mengakses <code class="docutils literal notranslate"><span class="pre">www.bankabc.com/profile</span></code> si server daripada <code class="docutils literal notranslate"><span class="pre">www.bankabc.com</span></code> akan mengira bahwa user tersebut sedang mau mengakses halaman profile tentang dirinya</p></li>
<li><p>padahal sebenarnya data daripada user tersebut nantinya akan terlihat dan disimpan ke dalam server <code class="docutils literal notranslate"><span class="pre">www.situslain.com</span></code></p></li>
</ol>
<p>Dikarenakan adanya celah keamanan itulah maka modern browser menerapkan adanya <code class="docutils literal notranslate"><span class="pre">same-origin</span> <span class="pre">policy</span></code> dalam setiap adanya <code class="docutils literal notranslate"><span class="pre">CORS</span></code>.</p>
<p>Alasan terbesar adalah mekanisme browser yang dapat menyimpan data user ke dalam client app (browser) seperti misal <code class="docutils literal notranslate"><span class="pre">cookie</span></code>.</p>
<p>Dan ini tentu tidak sama seperti <code class="docutils literal notranslate"><span class="pre">CURL</span></code> atau <code class="docutils literal notranslate"><span class="pre">WGET</span></code> yang mana dalam pengaksesannya tidak menyimpan sama sekali adanya data dari client (<cite>cookie</cite>).</p>
<p><cite>Authentication</cite> pada browser sebagian besar akan menggunakan <code class="docutils literal notranslate"><span class="pre">cookie</span></code>, terutama pada modern browser dewasa ini.</p>
<p>Penggunaan session sendiri sudah mulai jarang digunakan setelah teknologi seperti <code class="docutils literal notranslate"><span class="pre">node.js</span></code> muncul.</p>
<p>Sebelumnya pada PHP mekanisme <cite>authorization</cite> masih menggunakan adanya session (seperti <code class="docutils literal notranslate"><span class="pre">$_SESSION['nama_session']</span></code>) yang mana ini tersimpan ke dalam server (backend) dan bukan client (browser).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Penggunaan session sejatinya lebih <code class="docutils literal notranslate"><span class="pre">secure</span></code>, mengingat session hanya disimpan ke dalam server itu sendiri.</p>
<p>Selain itu pada mekanisme session akan menyimpan data yang berkaitan dengan pengaksesan dari <cite>user</cite> seperti IP address, browser, dll.</p>
<p>Sehingga ketika user mengakses pada routing server, maka server akan mengenali dan akan memberikan adanya response yang dibutuhkan.</p>
<p>sehingga pada session benar benar tidak memerlukan adanya data yang dikirim dari client (browser).</p>
<p>Namun dengan adanya teknologi microservice, dimana antara client dan server sudah berbeda host (backend akan menggunakan konsep <cite>api</cite> dan client menggunakan <cite>static page</cite>) maka teknologi session tidak dapat diterapkan.</p>
<p>Teknologi session hanya dapat diterapkan jika semisal antara server (express) dan client (html) masih dalam satu host,</p>
<p>karena setelah melakukan request dan diproses di routing express, maka selanjutnya server akan melakukan rendering html.</p>
<p>Teknologi diatas akan jarang digunakan mengingat sudah terdapat adanya teknologi microservice yang mana server akan membuat JWT (json web token) yang selanjutnya akan disimpan oleh client (dari cookie atau local storage).</p>
<p>referensi : <a class="reference external" href="https://medium.com/&#64;sherryhsu/session-vs-token-based-authentication-11a6c5ac45e4">https://medium.com/&#64;sherryhsu/session-vs-token-based-authentication-11a6c5ac45e4</a></p>
</div>
<p>Cookie atau local storage browser biasa digunakan untuk menyimpan data user.</p>
<p>Biasanya <cite>Local storage</cite> hanya akan digunakan untuk menyimpan data seperti konfigurasi dari user itu sendiri.</p>
<p>Sedangkan <cite>Cookie</cite> biasanya menyimpan data untuk authentication.</p>
<p>Perbedaan keduanya adalah pada cookie memiliki expiration, sedangkan pada local storage tidak, sehingga proses authentication biasanya akan menggunakan cookie dalam menyimpan data <cite>token</cite>.</p>
<p>Alasannya adalah data user seperti <code class="docutils literal notranslate"><span class="pre">token</span></code> akan bersifat sementara (expired) sehingga suatu saat user harus masuk kembali (login), meskipun tak jarang pula web app menggunakan local storage untuk menyimpan data <cite>token</cite>.</p>
<p>Namun baik cookie atau local storage, kedua teknik tersebut masih disimpan di client (browser), sehingga ini sebenarnya masih memungkinkan adanya celah keamanan yang sama.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Cookie sebenarnya hanya tersimpan dalam <strong>satu</strong> situs saja, misalkan user a melakukan login di <code class="docutils literal notranslate"><span class="pre">www.bankabc.com</span></code>, maka setelahnya di dalam web app tersebut (www.bankabc.com) akan memuat cookie seperti:</p>
<ul class="simple">
<li><p>username : a</p></li>
<li><p>token : 3H35lo52C…</p></li>
</ul>
<p>Yang nantinya user a harus memberikan cookie tersebut dalam mengakses halaman lain di www.bankabc.com.</p>
<p>Sedangkan jika user a mengakses www.situslain.com, maka cookie daripada www.bankabc.com tidak akan dapat digunakan.</p>
<p>Namun terkadang hacker bisa saja membajak <cite>networks user</cite> kemudian mencuri cookie user tersebut.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Bahkan untuk selevel google saja yang bersifat public tidak menerapkan adanya CORS (tidak memberikan response header), sehingga akses seperti fetch(“<a class="reference external" href="https://google.com/search?q=javascript">https://google.com/search?q=javascript</a>”) tidak akan dapat diakses (same-origin policy)</p>
</div>
</div>
<div class="section" id="menerapkan-akses-dengan-cors-control-allow-header-origin">
<h4>Menerapkan akses dengan CORS (control allow header origin)<a class="headerlink" href="#menerapkan-akses-dengan-cors-control-allow-header-origin" title="Permalink to this headline">¶</a></h4>
<p>Perlu diketahui bahwa CORS sejatinya jarang digunakan di beberapa web app dan mungkin bukanlah hal yang wajib perlu dibuat di server (back end).</p>
<p>Penggunaan CORS biasanya adalah untuk memberikan adanya <cite>whitelist</cite> pada satu domain (origin) saja, sehingga web tersebut bisa mengakses content/resource.</p>
<p>Atau bisa saja suatu web app akan membuat dapat diakses oleh siapa saja (bersifat public) dengan menggunakan value <cite>*</cite>.</p>
<p>Berikut adalah contoh penerapan CORS pada <code class="docutils literal notranslate"><span class="pre">express</span></code>, dimana si pengakses akan mengakses melalui host <code class="docutils literal notranslate"><span class="pre">localhost:3000</span></code> (origin host : <cite>localhost</cite> dan port : <cite>3000</cite>).</p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">function</span> <span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">//</span> <span class="n">Website</span> <span class="n">you</span> <span class="n">wish</span> <span class="n">to</span> <span class="n">allow</span> <span class="n">to</span> <span class="n">connect</span>
        <span class="n">res</span><span class="o">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s1">&#39;Access-Control-Allow-Origin&#39;</span><span class="p">,</span> <span class="s1">&#39;http://localhost:3000&#39;</span><span class="p">);</span>
        <span class="nb">next</span><span class="p">();</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Artinya ketika terdapat akses dari <cite>http://localhost:3000</cite> seperti fetch(‘<a class="reference external" href="http://localhost:5000">http://localhost:5000</a>’), maka server di express akan memperbolehkan akses.</p>
<p>Mengapa ?</p>
<p>Karena server (express) telah memberikan adanya response berupa header bernama ‘Access-Control-Allow-Origin’ dengan value berupa host dari origin lain.</p>
<p>Kunci utama dalam penggunaan CORS adalah menyesuaikan adanya <cite>response header</cite> yang diperlukan, response header ini bisa dilihat saat terdapat error di console.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Jika menggunakan server seperti <cite>nodejs</cite> atau <cite>express</cite> maka CORS akan diberikan di response atau pada bagian <cite>res</cite>.</p>
<p>Sehingga ketika diakses dari origin luar (cross-origin) maka origin luar tersebut telah mendapatkan <cite>response header</cite> yang telah dikirimkan dari nodejs/express tadi.</p>
<p>atau secara singkat, maka dari back end yang menyediakan response header agar servernya sendiri dapat diakses.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Lantas kenapa bisa mengakses resource seperti <cite>image</cite> dari web luar, misal <code class="docutils literal notranslate"><span class="pre">&lt;img</span> <span class="pre">src=&quot;https://wallpapercave.com/wp/wp2705709.jpg&quot;&gt;</span></code> ??? bukankah dengan adanya CORS maka sebenarnya tidak akan mungkin bisa.</p>
<p>Secara default, browser memperbolehkan adanya pengaksesan request dengan method GET jika melalui tag HTML seperti <code class="docutils literal notranslate"><span class="pre">&lt;img&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code>, dll.</p>
<p>Sedangkan jika menggunakan teknik <code class="docutils literal notranslate"><span class="pre">XHR</span></code> baik itu menggunakan <code class="docutils literal notranslate"><span class="pre">AJAX</span></code>, <code class="docutils literal notranslate"><span class="pre">XmlHttpRequest</span></code> atau <code class="docutils literal notranslate"><span class="pre">axios</span></code> maka browser akan menerapkan adanya <code class="docutils literal notranslate"><span class="pre">same</span> <span class="pre">origin</span> <span class="pre">policy</span></code>.</p>
<p>Jika melihat di bagian <code class="docutils literal notranslate"><span class="pre">inspect</span> <span class="pre">networks</span></code> pada chrome, maka akan terlihat beberapa jenis request seperti <code class="docutils literal notranslate"><span class="pre">XHR</span></code>, <code class="docutils literal notranslate"><span class="pre">css</span></code>, <code class="docutils literal notranslate"><span class="pre">img</span></code> dll.</p>
<p>Namun yang perlu diingat bahwa sejatinya pengaksesan menggunakan tag element HTML seperti <code class="docutils literal notranslate"><span class="pre">&lt;img&gt;</span></code> atau <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code> itu hanya menggunakan request dengan method <cite>GET</cite>.</p>
<p>Berikut adalah hasil pengaksesan menggunakan tag html <code class="docutils literal notranslate"><span class="pre">&lt;img&gt;</span></code> dan method <code class="docutils literal notranslate"><span class="pre">fetch</span></code> javascript saat me-load image.</p>
<p>Penggunaan tag html &lt;img&gt; akan berhasil</p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;img src=&quot;https://wallpapercave.com/wp/wp2705709.jpg&quot;&gt;

Request URL: https://wallpapercave.com/wp/wp2705709.jpg
Request Method: GET
Status Code: 200
Remote Address: 51.222.47.58:443
Referrer Policy: strict-origin-when-cross-origin
accept-ranges: bytes
content-length: 346039
content-type: image/jpeg
date: Sat, 17 Oct 2020 07:41:47 GMT
etag: &quot;5e503b80-547b7&quot;
last-modified: Fri, 21 Feb 2020 20:20:16 GMT
server: nginx
status: 200
x-frame-options: SAMEORIGIN
:authority: wallpapercave.com
:method: GET
:path: /wp/wp2705709.jpg
:scheme: https
accept: image/avif,image/webp,image/apng,image/*,*/*;q=0.8
accept-encoding: gzip, deflate, br
accept-language: en-US,en;q=0.9
cache-control: no-cache
pragma: no-cache
referer: http://localhost:3000/
sec-ch-ua: &quot;\\Not;A\&quot;Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;85&quot;, &quot;Chromium&quot;;v=&quot;85&quot;
sec-ch-ua-mobile: ?0
sec-fetch-dest: image
sec-fetch-mode: no-cors
sec-fetch-site: cross-site
user-agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
</pre></div>
</div>
<p>Sedangkan pengaksesan menggunakan <code class="docutils literal notranslate"><span class="pre">fetch</span></code> akan terkena adanya <cite>same origin policy</cite>:</p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>fetch(&#39;https://wallpapercave.com/wp/wp2705709.jpg&#39;, {
        method: &#39;GET&#39;
})
.then(response =&gt; response.json())
.then(data =&gt; {
        console.log(&#39;Success:&#39;, data);
})
.catch((error) =&gt; {
        console.error(&#39;Error:&#39;, error);
});

atau

fetch(&#39;https://wallpapercave.com/wp/wp2705709.jpg&#39;)


Request URL: https://wallpapercave.com/wp/wp2705709.jpg
Referrer Policy: strict-origin-when-cross-origin
accept-ranges: bytes
content-length: 346039
content-type: image/jpeg
date: Sat, 17 Oct 2020 07:41:47 GMT
etag: &quot;5e503b80-547b7&quot;
last-modified: Fri, 21 Feb 2020 20:20:16 GMT
server: nginx
status: 200
x-frame-options: SAMEORIGIN
Provisional headers are shown
Referer: http://localhost:3000/
sec-ch-ua: &quot;\\Not;A\&quot;Brand&quot;;v=&quot;99&quot;, &quot;Google Chrome&quot;;v=&quot;85&quot;, &quot;Chromium&quot;;v=&quot;85&quot;
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36
</pre></div>
</div>
<p>Sehingga itulah sebabnya mengapa situs seperti <code class="docutils literal notranslate"><span class="pre">pinterest</span></code>, <code class="docutils literal notranslate"><span class="pre">google</span> <span class="pre">image</span> <span class="pre">search</span></code> bisa mengakses secara bebas.</p>
<p>Namun nantinya ini juga akan memiliki celah keamanan tersendiri, dan akan dibahas pada materi <code class="docutils literal notranslate"><span class="pre">CSRF/XSRF</span></code>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>referensi : video ‘Cross Origin Resource Sharing (Explained by Example)-Ka8vG5miErk.mp4’</p>
<p>Jika semisal suatu server (back end) akan menerapkan CORS untuk method <code class="docutils literal notranslate"><span class="pre">POST</span></code>, <code class="docutils literal notranslate"><span class="pre">PUT</span></code>, <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> atau method lain, maka ada beberapa hal yang perlu dilakukan.</p>
<p>Seperti diketahui bahwa pengaksesan menggunakan method POST, PUT, DELETE akan memerlukan adanya header berupa <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> (dimana didalamnya biasanya adalah <cite>body data</cite> berupa <cite>JSON</cite>).</p>
<p>Untuk dapat menggunakan header tersebut, maka di server membutuhkan adanya method tambahan bernama <code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>.</p>
<p>Jika tidak diberikan adanya method <code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code>, maka secara normal request dengan method POST, PUT, atau DELETE akan ditolak.</p>
<p>Method <code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code> tersebut akan berisikan seperti berikut.</p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">express</span> <span class="o">=</span> <span class="n">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">)</span>
<span class="n">var</span> <span class="n">cors</span> <span class="o">=</span> <span class="n">require</span><span class="p">(</span><span class="s1">&#39;cors&#39;</span><span class="p">)</span>
<span class="n">var</span> <span class="n">app</span> <span class="o">=</span> <span class="n">express</span><span class="p">()</span>

<span class="n">app</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="s1">&#39;/products/:id&#39;</span><span class="p">,</span> <span class="n">cors</span><span class="p">())</span> <span class="o">//</span> <span class="n">enable</span> <span class="n">pre</span><span class="o">-</span><span class="n">flight</span> <span class="n">request</span> <span class="k">for</span> <span class="n">DELETE</span> <span class="n">request</span>

<span class="n">app</span><span class="o">.</span><span class="k">del</span><span class="p">(</span><span class="s1">&#39;/products/:id&#39;</span><span class="p">,</span> <span class="n">cors</span><span class="p">(),</span> <span class="n">function</span> <span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">res</span><span class="o">.</span><span class="n">json</span><span class="p">({</span><span class="n">msg</span><span class="p">:</span> <span class="s1">&#39;This is CORS-enabled for all origins!&#39;</span><span class="p">})</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Atau jika ingin memberlakukan pada semua route, dapat menggunakan dengan value <code class="docutils literal notranslate"><span class="pre">*</span></code></p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">cors</span><span class="p">())</span> <span class="o">//</span> <span class="n">diberikan</span> <span class="n">sebelum</span> <span class="n">route</span> <span class="n">utama</span>
</pre></div>
</div>
<p>Atau jika tidak menggunakan package seperti cors, maka bisa membuat dengan seperti berikut seperti berikut</p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">function</span> <span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">//</span> <span class="n">Website</span> <span class="n">you</span> <span class="n">wish</span> <span class="n">to</span> <span class="n">allow</span> <span class="n">to</span> <span class="n">connect</span>
        <span class="n">res</span><span class="o">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s1">&#39;Access-Control-Allow-Origin&#39;</span><span class="p">,</span> <span class="s1">&#39;http://localhost:3000&#39;</span><span class="p">);</span>
        <span class="o">//</span> <span class="n">Request</span> <span class="n">methods</span> <span class="n">you</span> <span class="n">wish</span> <span class="n">to</span> <span class="n">allow</span>
        <span class="n">res</span><span class="o">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s1">&#39;Access-Control-Allow-Methods&#39;</span><span class="p">,</span> <span class="s1">&#39;GET, POST, OPTIONS, PUT, PATCH, DELETE&#39;</span><span class="p">);</span>
        <span class="o">//</span> <span class="n">Request</span> <span class="n">headers</span> <span class="n">you</span> <span class="n">wish</span> <span class="n">to</span> <span class="n">allow</span>
        <span class="n">res</span><span class="o">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s1">&#39;Access-Control-Allow-Headers&#39;</span><span class="p">,</span> <span class="s1">&#39;X-Requested-With,content-type&#39;</span><span class="p">);</span>
        <span class="nb">next</span><span class="p">();</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="serangan-csrf-dan-xsrf">
<h4>Serangan CSRF dan XSRF<a class="headerlink" href="#serangan-csrf-dan-xsrf" title="Permalink to this headline">¶</a></h4>
<p>Pengaksesan <cite>CORS</cite> dengan tag HTML sebenarnya akan dapat membuat celah keamanan tersendiri seperti semisal tag <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code> yang di dalamnya adalah mengakses beberapa data penting.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Celah keamanan ini berada di origin itu sendiri (same origin) atau di web app itu sendiri.</p>
</div>
<p>Contoh termudah adalah dengan melakukan inject script, seperti diketahui bahwa browser terdapat adanya fitur edit html, dimana didalamnya akan dapat dengan mudah memberikan tag element <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code> baru.</p>
<p>Dan didalamnya akan mengakses beberapa situs penting.</p>
<p>Namun tentu ini tidak perlu dikhawatirkan karena ada 2 hal:</p>
<ol class="arabic">
<li><p>Teknologi pencegahan input berupa tag</p>
<blockquote>
<div><p>misal jika akan menginject script melalui <cite>input form</cite>, maka server telah mem-validasi dan menolaknya.</p>
</div></blockquote>
</li>
<li><p>Transaction ticket dan CSRF token</p>
<blockquote>
<div><p>Dan kalaupun sampai dapat menginject script, maka tidak akan bisa melakukan karena sudah ada penerapan transaction ticket atau csrf token yang ada di tiap form.</p>
<p>Misal di dalam script tersebut akan mengakses seperti:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;www.bankabc.com/users/1/getUsernameAndPassword&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="n">method</span> <span class="p">:</span> <span class="n">POST</span> <span class="p">});</span>
</pre></div>
</div>
<p>Namun tiap akses tanpa adanya <cite>transaction ticket</cite> atau <cite>CSRF token</cite> akan ditolak oleh server.</p>
<p><cite>transaction ticket</cite> atau <cite>CSRF token</cite> tersebut hanya akan digenerate oleh server itu sendiri, dan akan digenerate tiap kali ada request (seperti saat pertama kali akses atau refresh halaman).</p>
<p>Berikut penjelasan lebih lengkap tentang CSRF token atau transaction ticket</p>
<ul class="simple">
<li><p><a class="reference external" href="https://stackoverflow.com/a/29167709">https://stackoverflow.com/a/29167709</a></p></li>
<li><p><a class="reference external" href="https://stackoverflow.com/a/27294846">https://stackoverflow.com/a/27294846</a> (where CRSF Tokens is bolded).</p></li>
</ul>
<p>Atau secara singkat dalam menggunakan akses tersebut maka perlu adanya token khusus di tiap akses, seperti “www.detik.com/admin/getUsernameAndPassword?token=ONLYGENERATEBYSERVER”, sehingga hacker akan sulit memberikan token.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Pada laravel sendiri, ketika membuka suatu form pada halaman web, maka ia memerlukan adanya <code class="docutils literal notranslate"><span class="pre">CSRF</span> <span class="pre">token</span></code>, dimana ini akan menghindari adanya serangan CSRF/XSRF.</p>
<p>CSRF token ini akan diproses pada middleware (<code class="docutils literal notranslate"><span class="pre">VerifyCRSFToken</span></code>), dan jika tidak terdapat token, atau token salah, maka akses akan ditolak.</p>
</div>
</div></blockquote>
</li>
</ol>
<p>Namun perlu diingat bahwa <cite>transaction ticket</cite> atau <cite>CSRF token</cite> ini hanya berlaku pada browser (via web app), dan tidak berlaku pada penggunaan <code class="docutils literal notranslate"><span class="pre">API</span></code>.</p>
<p>Karena pada API hanya akan menggunakan adanya token dari si user tersebut dalam mengakses.</p>
<p>Pada laravel saat menggunakan <cite>api</cite> (bukan web app), maka middleware <cite>VerifyCRSFToken</cite> harus dimatikan.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Yang perlu dikhawatirkan sebenarnya adalah tidak berfungsinya CORS, sehingga suatu web app, dapat mengakses tanpa adanya filter <cite>Same-Origin</cite> policy.</p>
<p>Atau mungkin dengan adanya pencurian cookie, sehingga dapat digunakan oleh hacker.</p>
<p>Jika semisal CORS tidak berfungsi, maka hacker bisa melakukan transaction (dari route seperti www.domain.com/transferMoney atau www.domain.com/profile/getUsernameAndPassword)</p>
<p>Atau jika semisal cookie sudah didapat oleh hacker, maka hacker bisa login dan mengubah password.</p>
<p>Oleh karenanya dibutuhkan adanya proteksi ekstra dari back end dalam celah keamanan tersebut.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Sejatinya penggunaan tag element seperti &lt;img&gt; atau &lt;script&gt; pada browser tidak akan dapat mengakses suatu halaman, semisal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;www.detik.com/admin&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;www.detik.com/admin/getUsernameAndPassword&quot;</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Akan terdapat error, karena tag element html hanya khusus me-load content/resource dan bukan halaman page.</p>
</div>
</div>
<div class="section" id="kesimpulan-cors">
<h4>Kesimpulan CORS<a class="headerlink" href="#kesimpulan-cors" title="Permalink to this headline">¶</a></h4>
<p>Sejatinya CORS akan sangat jarang menggunakan Ajax/XHR, dan biasanya hanya dengan tag HTML.</p>
<p>Pada client (browser) telah menerapkan adanya <cite>same-origin policy</cite>, membuat pengaksesan dari luar origin (luar situs) akan diblok.</p>
<p>Selain itu dalam server juga telah menerapkan adanya <cite>CSRF token</cite> atau <cite>transaction ticket</cite>, sehingga akan sulit diakses tanpa kedua data tersebut.</p>
<p>Dengan begini maka akan terdapat double protection yaitu ?</p>
<ol class="arabic">
<li><p>Keamanan dari browser/client</p>
<blockquote>
<div><p>Hacker tidak dapat mengakses melalui suatu situs (yang mungkin user mengaksesnya) karena adanya same origin policy</p>
</div></blockquote>
</li>
<li><p>Kemanan dari server/back end</p>
<blockquote>
<div><p>Hacker tidak dapat mengakses melalui fetch, XHR karena <cite>tidak terdapat</cite> atau <cite>ketidakcocokan</cite> csrf token atau transaction ticket yang harus disertakan.</p>
</div></blockquote>
</li>
</ol>
<p>referensi:</p>
<p><a class="reference external" href="https://kelaskita.com/blog/memahami-csrf-dan-manfaat-nya/">https://kelaskita.com/blog/memahami-csrf-dan-manfaat-nya/</a>
<a class="reference external" href="https://mti.binus.ac.id/2018/07/11/cross-site-request-forgery/">https://mti.binus.ac.id/2018/07/11/cross-site-request-forgery/</a>
<a class="reference external" href="https://medium.com/&#64;dtkatz/3-ways-to-fix-the-cors-error-and-how-access-control-allow-origin-works-d97d55946d9">https://medium.com/&#64;dtkatz/3-ways-to-fix-the-cors-error-and-how-access-control-allow-origin-works-d97d55946d9</a>
<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS</a>
<a class="reference external" href="https://www.youtube.com/watch?v=M_nIIcKTxGk&amp;list=PL1A2CSdiySGIRec2pvDMkYNi3iRO89Zot">https://www.youtube.com/watch?v=M_nIIcKTxGk&amp;list=PL1A2CSdiySGIRec2pvDMkYNi3iRO89Zot</a></p>
</div>
</div>
<div class="section" id="react-proxy">
<h3>React Proxy<a class="headerlink" href="#react-proxy" title="Permalink to this headline">¶</a></h3>
<p>Saat melakukan adanya development pada React, maka secara default react akan membuat server sendiri (seperti <code class="docutils literal notranslate"><span class="pre">localhost:3000</span></code>), hanya saja dengan begini ketika akan mengakses server (seperti <cite>express</cite>) maka akan gagal karena dianggap sebagai CORS dan terkena <cite>same origin policy</cite>.</p>
<p>Dalam case ini maka terdapat adanya beberapa solusi :</p>
<ol class="arabic simple">
<li><p>menggunakan react proxy (diset dari react sendiri)</p></li>
<li><p>menambahkan response header yang diperlukan (diset dari server backend)</p></li>
<li><p>menggunakan socket.io (penulis belum memahami)</p></li>
</ol>
<p>Cara <cite>response header</cite> telah dibahas sebelumnya, artinya dari server hanya perlu memberikan adanya response header yang diperlukan.</p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">function</span> <span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="nb">next</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">//</span> <span class="n">Website</span> <span class="n">you</span> <span class="n">wish</span> <span class="n">to</span> <span class="n">allow</span> <span class="n">to</span> <span class="n">connect</span>
        <span class="n">res</span><span class="o">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s1">&#39;Access-Control-Allow-Origin&#39;</span><span class="p">,</span> <span class="s1">&#39;http://localhost:3000&#39;</span><span class="p">);</span>
        <span class="o">//</span> <span class="n">Request</span> <span class="n">methods</span> <span class="n">you</span> <span class="n">wish</span> <span class="n">to</span> <span class="n">allow</span>
        <span class="n">res</span><span class="o">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s1">&#39;Access-Control-Allow-Methods&#39;</span><span class="p">,</span> <span class="s1">&#39;GET, POST, OPTIONS, PUT, PATCH, DELETE&#39;</span><span class="p">);</span>
        <span class="o">//</span> <span class="n">Request</span> <span class="n">headers</span> <span class="n">you</span> <span class="n">wish</span> <span class="n">to</span> <span class="n">allow</span>
        <span class="n">res</span><span class="o">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s1">&#39;Access-Control-Allow-Headers&#39;</span><span class="p">,</span> <span class="s1">&#39;X-Requested-With,content-type&#39;</span><span class="p">);</span>
        <span class="nb">next</span><span class="p">();</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Kemudian sekarang akan dibahas penggunaan proxy, untuk socket io akan dibahas pada materi lain.</p>
<div class="section" id="bagaimana-react-menggunakan-proxy">
<h4>Bagaimana React menggunakan <code class="docutils literal notranslate"><span class="pre">proxy</span></code> ?<a class="headerlink" href="#bagaimana-react-menggunakan-proxy" title="Permalink to this headline">¶</a></h4>
<p>Apa itu proxy ?</p>
<p>Secara umum proxy adalah server/service yang mana akan memperkenalkan layer tambahan saat komunikasi untuk menyelundupkan/memodifikasi content.</p>
<p>Contoh termudah seperti mem-proxy IP address kita ketika send request mengakses video youtube yang mana dilarang di negara sendiri</p>
<p>Proxy pada react untuk apa ?</p>
<p>Pada konteks development web, tujuan utama proxy adalah mencegah adanya isu <code class="docutils literal notranslate"><span class="pre">CORS</span></code> (Cross Origin Resource Sharing) yang mana terjadi karena browser “memaksakan” <cite>Same-Origin Policy</cite> untuk melindungi user dari XSS.</p>
<p>Ini tidak akan menjadi masalah jika semisal app react telah di-build ke dalam production (seperti misal menggunakan <code class="docutils literal notranslate"><span class="pre">webpack</span></code>) dan menjadi <code class="docutils literal notranslate"><span class="pre">static</span> <span class="pre">page</span></code>.</p>
<p>Dimana artinya nantinya react akan berada pada same-origin dan isu same-origin policy tidak akan terjadi (karena tidak menggunakan CORS)</p>
<p>Namun pada mode <cite>development</cite> mau tidak mau, react akan memiliki host tersendiri, dan tentu pengaksesan di suatu server akan dianggap sebagai CORS dan <cite>same-origin policy</cite> akan diberlakukan.</p>
<p>Untuk React memiliki fitur bernama <code class="docutils literal notranslate"><span class="pre">Proxy</span></code>.</p>
<p>Seperti diketahui bahwa proxy sama halnya dengan <code class="docutils literal notranslate"><span class="pre">VPN</span></code>, artinya pada react ketika mengakses localhost:3000/users (pada react) itu sebenarnya akan diganti menjadi <code class="docutils literal notranslate"><span class="pre">localhost:5000/users</span></code></p>
<p>Berikut beberapa cara dalam menerapkan proxy pada react:</p>
<ol class="arabic">
<li><p>Default Proxy (dari react itu sendiri) - simple version</p>
<blockquote>
<div><p>Berikut jika semisal menggunakan fetch/XHR pada react tanpa memberikan adanya proxy</p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;/search?q=javascript&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">resp</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;======success=======&#39;</span><span class="p">);</span>
        <span class="p">})</span>
        <span class="o">.</span><span class="n">catch</span><span class="p">(</span><span class="n">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;======failure=======&#39;</span><span class="p">);</span>
                <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">err</span><span class="p">);</span>
        <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Akan terjadi <strong>error</strong>.</p>
<p>Tapi jika menambahkan adanya proxy (ke dalam <code class="docutils literal notranslate"><span class="pre">package.json</span></code>), maka request ke <code class="docutils literal notranslate"><span class="pre">https://google.com</span></code> akan dibuat proxy dan kita dapat me-load informasi dari google.com tersebut.</p>
<p>file <code class="docutils literal notranslate"><span class="pre">package.json</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="o">...</span>
        <span class="s2">&quot;proxy&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.google.com&quot;</span><span class="p">,</span>
<span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Yaitu saat akses melalui localhost:3000/search?q=javascript, maka ini sama saja akan mengakses https://google.com/search?q=javascript.</p>
<p>Pada javascript terdapat package yang khusus menangani proxy seperti <code class="docutils literal notranslate"><span class="pre">node-http-proxy</span></code>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Proxy pada react hanya akan terjadi saat menggunakan</p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;http://localhost:3000/search?q=javascript&#39;</span><span class="p">)</span>
<span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">resp</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;======success=======&#39;</span><span class="p">);</span>
<span class="p">})</span>
<span class="o">.</span><span class="n">catch</span><span class="p">(</span><span class="n">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;======failure=======&#39;</span><span class="p">);</span>
        <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">err</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Jika menggunakan cara diatas, maka proxy akan tetap berjalan.</p>
<p>Namun jika langsung dengan mengetikkan host diluar react maka tentu proxy tidak akan berjalan.</p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;https://google.com/search?q=javascript&#39;</span><span class="p">)</span>
<span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">resp</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;======success=======&#39;</span><span class="p">);</span>
<span class="p">})</span>
<span class="o">.</span><span class="n">catch</span><span class="p">(</span><span class="n">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;======failure=======&#39;</span><span class="p">);</span>
        <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">err</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Jika menggunakan cara diatas, maka <cite>same-origin policy</cite> akan berjalan dan hasilnya adalah error.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Penggunaan proxy tidak akan bisa digunakan untuk aktivitas hacking.</p>
<p>misalkan adalah backend`` www.situslain.com`` sudah dipasangi adanya package seperti <code class="docutils literal notranslate"><span class="pre">node-http-proxy</span></code>.</p>
<p>lalu ada user yang telah login di <code class="docutils literal notranslate"><span class="pre">www.bankabc.com</span></code> (terdapat adanya cookie) kemudian secara tidak sadar mengakses <code class="docutils literal notranslate"><span class="pre">www.situslain.com/profile</span></code>, yang mana ini sama saja mengakses <code class="docutils literal notranslate"><span class="pre">www.bankabc.com/profile</span></code></p>
<p>Tapi selama data seperti <cite>cookie</cite> ataupun <cite>local storage</cite> tidak dapat diakses (karena ini disimpan di tiap web app) maka akan tetap aman.</p>
</div>
</div></blockquote>
</li>
<li><p>Default Proxy - custom path target version</p>
<blockquote>
<div><p>Dikarenakan tidak semua request akan menuju ke server yang sama, bisa mendefinisikan “path” dan “target” untuk tiap path(slash)</p>
<p>file <code class="docutils literal notranslate"><span class="pre">package.json</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="o">...</span>
        <span class="s2">&quot;proxy&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;/search&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.google.com&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;changeOrigin&quot;</span><span class="p">:</span> <span class="n">true</span>
                <span class="p">},</span>
                <span class="s2">&quot;/todos&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;http://jsonplaceholder.typicode.com/&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;changeOrigin&quot;</span><span class="p">:</span> <span class="n">true</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;/search?q=javascript&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">resp</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;======success search request=======&#39;</span><span class="p">);</span>
                <span class="n">this</span><span class="o">.</span><span class="n">processResp</span><span class="p">(</span><span class="n">resp</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;/todos&#39;</span><span class="p">);</span>
        <span class="p">})</span>
        <span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">todos</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;======success todos request=======&#39;</span><span class="p">);</span>
                <span class="n">todos</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">json</span> <span class="o">=&gt;</span> <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">json</span><span class="p">));</span>
        <span class="p">})</span>
        <span class="o">.</span><span class="n">catch</span><span class="p">(</span><span class="n">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;======failure=======&#39;</span><span class="p">);</span>
                <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">err</span><span class="p">);</span>
        <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>dalam case diatas maka yang terjadi adalah:</p>
<ul class="simple">
<li><p>akses <code class="docutils literal notranslate"><span class="pre">localhost:3000/search</span></code> akan seperti mengakses <code class="docutils literal notranslate"><span class="pre">www.google.com/search</span></code></p></li>
<li><p>akses <code class="docutils literal notranslate"><span class="pre">localhost:3000/todos</span></code> akan seperti mengakses <code class="docutils literal notranslate"><span class="pre">http://jsonplaceholder.typicode.com/todos</span></code></p></li>
</ul>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>mencoba dengan axios juga tidak akan jauh berbeda</p>
<p>file <code class="docutils literal notranslate"><span class="pre">package.json</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="o">...</span>
        <span class="s2">&quot;proxy&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;/search&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.google.com&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;changeOrigin&quot;</span><span class="p">:</span> <span class="n">true</span>
                <span class="p">},</span>
                <span class="s2">&quot;/todos&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;http://jsonplaceholder.typicode.com/&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;changeOrigin&quot;</span><span class="p">:</span> <span class="n">true</span>
                <span class="p">},</span>
                <span class="s2">&quot;/posts&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;https://jsonplaceholder.typicode.com&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;changeOrigin&quot;</span><span class="p">:</span> <span class="n">true</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;/search?q=javascript&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">resp</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;======success search request=======&#39;</span><span class="p">);</span>
                <span class="n">this</span><span class="o">.</span><span class="n">processResp</span><span class="p">(</span><span class="n">resp</span><span class="p">);</span>
                <span class="k">return</span> <span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;/todos&#39;</span><span class="p">);</span>
        <span class="p">})</span>
        <span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">todos</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;======success todos request=======&#39;</span><span class="p">);</span>
                <span class="n">todos</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">json</span> <span class="o">=&gt;</span> <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">json</span><span class="p">));</span>
                <span class="k">return</span> <span class="n">axios</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/posts&#39;</span><span class="p">);</span>
        <span class="p">})</span>
        <span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">posts</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;======success posts request=======&#39;</span><span class="p">);</span>
                <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">posts</span><span class="p">);</span>
        <span class="p">})</span>
        <span class="o">.</span><span class="n">catch</span><span class="p">(</span><span class="n">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;======failure=======&#39;</span><span class="p">);</span>
                <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">err</span><span class="p">);</span>
        <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>referensi:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://create-react-app.dev/docs/proxying-api-requests-in-development/">https://create-react-app.dev/docs/proxying-api-requests-in-development/</a></p></li>
<li><p><a class="reference external" href="https://medium.com/bb-tutorials-and-thoughts/react-how-to-proxy-to-backend-server-5588a9e0347">https://medium.com/bb-tutorials-and-thoughts/react-how-to-proxy-to-backend-server-5588a9e0347</a></p></li>
<li><p><a class="reference external" href="https://levelup.gitconnected.com/overview-of-proxy-server-and-how-we-use-them-in-react-bf67c062b929">https://levelup.gitconnected.com/overview-of-proxy-server-and-how-we-use-them-in-react-bf67c062b929</a></p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="package-react-router-sejatinya-bukan-url-namun-hanya-semacam-routing-di-browser">
<h2>Package <code class="docutils literal notranslate"><span class="pre">react-router</span></code> sejatinya bukan url namun hanya semacam <cite>routing</cite> di browser<a class="headerlink" href="#package-react-router-sejatinya-bukan-url-namun-hanya-semacam-routing-di-browser" title="Permalink to this headline">¶</a></h2>
<p>bisa dilakukan antara akses melalui <cite>CURL</cite> dan web browser (click dan refresh)</p>
<ol class="arabic simple">
<li><p>CURL</p></li>
</ol>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">3000</span><span class="o">/</span><span class="n">users</span>

<span class="p">[</span>
        <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Leanne Graham&quot;</span><span class="p">,</span>
                <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;Cs1900&quot;</span><span class="p">,</span>
                <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="s2">&quot;22&quot;</span><span class="p">,</span>
                <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;Sincere@april.biz&quot;</span><span class="p">,</span>
                <span class="s2">&quot;companyId&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;street&quot;</span><span class="p">:</span> <span class="s2">&quot;Kulas Light&quot;</span><span class="p">,</span>
                <span class="s2">&quot;suite&quot;</span><span class="p">:</span> <span class="s2">&quot;Apt. 556&quot;</span><span class="p">,</span>
                <span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="s2">&quot;Gwenborough&quot;</span><span class="p">,</span>
                <span class="s2">&quot;zipcode&quot;</span><span class="p">:</span> <span class="s2">&quot;92998-3874&quot;</span><span class="p">,</span>
                <span class="s2">&quot;geo&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="s2">&quot;-37.3159&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;lng&quot;</span><span class="p">:</span> <span class="s2">&quot;81.1496&quot;</span>
                <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;phone&quot;</span><span class="p">:</span> <span class="s2">&quot;1-770-736-8031 x56442&quot;</span><span class="p">,</span>
                <span class="s2">&quot;website&quot;</span><span class="p">:</span> <span class="s2">&quot;hildegard.org&quot;</span><span class="p">,</span>
                <span class="s2">&quot;company&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Romaguera-Crona&quot;</span><span class="p">,</span>
                <span class="s2">&quot;catchPhrase&quot;</span><span class="p">:</span> <span class="s2">&quot;Multi-layered client-server neural-net&quot;</span><span class="p">,</span>
                <span class="s2">&quot;bs&quot;</span><span class="p">:</span> <span class="s2">&quot;harness real-time e-markets&quot;</span>
                <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Ervin Howell&quot;</span><span class="p">,</span>
                <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;Antonette&quot;</span><span class="p">,</span>
                <span class="s2">&quot;age&quot;</span><span class="p">:</span> <span class="s2">&quot;25&quot;</span><span class="p">,</span>
                <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;Shanna@melissa.tv&quot;</span><span class="p">,</span>
                <span class="s2">&quot;companyId&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>NB: di <code class="docutils literal notranslate"><span class="pre">postman</span></code> sendiri juga akan menampilkan seperti diatas.</p>
<ol class="arabic simple">
<li><p>Browser</p></li>
</ol>
<p>Jika semisal terdapat component &lt;Link&gt; pada react maka di browser akan menghasilkan html dengan tulisan:</p>
<p>html -&gt; Hello, Users</p>
<p>Sedangkan jika di browser dilakukan dengan mengetikkan secara penuh (localhost:3000/users) dan menekan enter hasilnya adalah list user seperti teknik CURL diatas</p>
<p>react sendiri disarankan untuk menggunakan package nextjs, untuk masalah server-side-rendering.</p>
<div class="section" id="hal-ini-tidak-berlaku-jika-semisal-menggunakan-dengan">
<h3>Hal ini tidak berlaku jika semisal menggunakan dengan ,<a class="headerlink" href="#hal-ini-tidak-berlaku-jika-semisal-menggunakan-dengan" title="Permalink to this headline">¶</a></h3>
<p>misalkan mengakses localhost:3000/mystory pada web app (react).</p>
<p>maka bukan berarti itu bisa diakses dari curl, karena itu adalah penggunaan daripada <cite>react-router</cite> package</p>
<p>nah beda cerita kalau router <cite>mystory</cite> (express) itu berada setelah static page</p>
<p>misal berikut ,maka dia bakal kena react (react router), yang jelas ditaruh di bawah sendiri</p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="k">if</span> <span class="n">the</span> <span class="n">application</span> <span class="n">deployed</span><span class="p">(</span><span class="s1">&#39;production&#39;</span><span class="p">),</span> <span class="n">use</span> <span class="n">this</span> <span class="n">to</span> <span class="n">access</span> <span class="n">static</span> <span class="n">page</span> <span class="p">(</span><span class="n">front</span> <span class="n">end</span><span class="p">)</span> <span class="ow">and</span> <span class="n">to</span> <span class="n">create</span> <span class="nb">all</span> <span class="n">the</span> <span class="n">path</span> <span class="n">route</span> <span class="n">redirect</span> <span class="n">on</span> <span class="n">front</span> <span class="n">end</span> <span class="n">html</span>
<span class="k">if</span> <span class="p">(</span><span class="n">process</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">NODE_ENV</span> <span class="o">===</span> <span class="s1">&#39;production&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="o">//</span> <span class="n">to</span> <span class="n">access</span> <span class="n">static</span> <span class="n">page</span> <span class="n">DO</span> <span class="n">NOT</span> <span class="n">use</span> <span class="n">the</span> <span class="n">html</span> <span class="n">file</span><span class="p">,</span> <span class="n">ext</span> <span class="s1">&#39;client/build/index.html&#39;</span>
        <span class="n">app</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="n">express</span><span class="o">.</span><span class="n">static</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">__dirname</span><span class="p">,</span> <span class="s1">&#39;client/build&#39;</span><span class="p">)));</span>

        <span class="o">//</span> <span class="n">to</span> <span class="n">access</span> <span class="ow">in</span> <span class="nb">all</span> <span class="n">route</span> <span class="n">path</span> <span class="n">DO</span> <span class="n">NOT</span> <span class="n">use</span> <span class="n">the</span> <span class="n">directory</span><span class="p">,</span> <span class="n">exp</span> <span class="s1">&#39;/client/build&#39;</span>
        <span class="n">app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="n">res</span><span class="o">.</span><span class="n">sendFile</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">__dirname</span> <span class="o">+</span> <span class="s1">&#39;/client/build/index.html&#39;</span><span class="p">));</span>
        <span class="p">});</span>
<span class="p">}</span>

<span class="n">app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/mystory&#39;</span><span class="p">,</span> <span class="n">function</span> <span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">res</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;mystory&#39;</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="session-based-authentication-vs-token-based-authentication-case-session-vs-jwt">
<h2>session based authentication vs token based authentication (case SESSION vs JWT)<a class="headerlink" href="#session-based-authentication-vs-token-based-authentication-case-session-vs-jwt" title="Permalink to this headline">¶</a></h2>
<div class="section" id="php-session-dan-cookie">
<h3>PHP session dan cookie<a class="headerlink" href="#php-session-dan-cookie" title="Permalink to this headline">¶</a></h3>
<p>pada PHP terdapat teknologi yang khusus untuk menyimpan data di “tiap” client, bernama <cite>session</cite>.
session ini akan selalu ada selama user tidak melakukan logout (yang mana ini akan menjalankan <cite>destroy session</cite>)</p>
<p>penggunaan teknologi session di php akan menyimpan data ke dalam <cite>server</cite> dan <cite>client</cite>.
data di dalam server disebut sebagai <cite>session</cite>, sedangkan data di dalam client (browser) disebut sebagai <cite>cookie</cite>.
atau secara mudahnya <cite>session</cite> akan disimpan ke server dan <cite>cookie</cite> akan disimpan ke client (browser)</p>
<p>Untuk bisa menggunakan session di php perlu menuliskan adanya code <cite>session_start()</cite> yang diletakkan di code paling atas.
Setelahnya php akan membuat session baru atau membaca session yang sudah ada
pada server akan menyimpan file session (session_id) yang biasanya disimpan ke dalam direktori <code class="docutils literal notranslate"><span class="pre">php/temp</span></code> (sesuai setting di php.ini).
kemudian php akan mengirimkan juga ke client (browser) yang bernama cookie, yang mana ini akan berisikan <cite>session_id</cite> tadi.
jika dilihat di browser, maka akan terlihat cookie bernama <cite>PHPSESSID</cite> dengan value random id (session_id).</p>
<p>Session nantinya dapat digunakan sebagai penyimpanan di tiap user.
semisal</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$_SESSION[&quot;hobi&quot;] = &quot;Main Komputer&quot;;
$_SESSION[&quot;status&quot;] = &quot;Sudah Login&quot;;

echo &quot;&lt;pre&gt;&quot;;
print_r($_SESSION);
echo &quot;&lt;/pre&gt;&quot;;
</pre></div>
</div>
<p>ketika client me-request ke server (php), maka php akan membaca session_id( dari <cite>cookie</cite> client) dan selanjutnya membaca data session (sesuai dengan <cite>session_id</cite> dari client).
artinya cookie disini akan digunakan sebagai <cite>tiket</cite> untuk mengakses data session 9sesuai dengan session_id).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>PHP sejatinya menerapkan 2 metode untuk me-track session yaitu cookie dan query string (pada url).</p>
<p>Hanya saja query string dianggap tidak baik untuk SEO, sehingga kebanyakan akan menggunakan cookie</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Dalam browser (misal chrome) akan menggunakan penyimpanan data cookie sesuai dengan domain (<cite>domain cookie</cite>), yang berarti tiap domain akan menyimpan cookie nya masing masing.</p>
<p>Artinya jika mencoba membuka tab baru atau bahkan new browser, ketika domainnya masih sama (semisal www.domain.com) maka data cookie akan tetap sama.</p>
<p>Tetapi jika membuka domain yang sama pada browser lain, maka cookie ini akan berbeda (yang artinya session_id juga akan berbeda).</p>
</div>
<p>Penggunaan session pada php biasanya diperuntukkan untuk authentication, misal setelah mencocokkan dengan data user di database, maka php akan menyimpand data session seperti berikut</p>
<p>code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$_SESSION[&quot;loggedin&quot;] = true;
$_SESSION[&quot;id&quot;] = $id;
$_SESSION[&quot;username&quot;] = $username;
</pre></div>
</div>
<p>Nantinya tiap client request ke server (php) maka php akan membaca session_id dan menemukan bahwa user tersebut telah memiliki data session, dan dapat mengakses halaman user.</p>
<p>kekurangan teknologi ini :</p>
<p>file session disimpan ke dalam server yang mana ini lama lama akan membebani di server sendiri, karena bisa saja user akan terlalu banyak
selain itu teknologi ini hanya akan dapat disimpan pada satu server saja, sehingga ketika melakukan scaling seperti menggunakan microservice (container &amp; orchestration) tidak akan dapat diterapkan.
karena bisa saja akses back end dialihkan ke container (server back end) yang lain.</p>
<p>alternatif lain untuk authentication adalah menggunakan package JWT.
yang mana tiap client request, maka dia menyertakan token  (yang dikirim lewat header).
kemudian server hanya perlu melakukan <code class="docutils literal notranslate"><span class="pre">un-serialize</span></code> token tersebut (yang mana ini membutuhkan adanya <cite>secret_key</cite>)
kemudian akan mengetahui data seperti <cite>id</cite>, <cite>username</cite>, dll</p>
</div>
<div class="section" id="jwt">
<h3>JWT<a class="headerlink" href="#jwt" title="Permalink to this headline">¶</a></h3>
<p>json web token</p>
</div>
</div>
<div class="section" id="disable-play-video-dengan-cors">
<h2>Disable play video dengan CORS<a class="headerlink" href="#disable-play-video-dengan-cors" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Penulis belum yakin ini bisa diterapkan atau tidak.</p>
<p>Karena tetap cors itu hanya dari client, artinya ketika client sudah akses, maka dia akan mengetahui apakah telah terdapat adanya response header <cite>control-allow-origin</cite></p>
<p>sedangkan dari server, tentu mau bagaimanapun tetap tidak akan bisa menolak streaming</p>
</div>
<p>teknologi cors itu</p>
<p>misal ada video</p>
<p>nah disimpen di server
tapi kalau di play di server itu (pake get) akan bisa</p>
<p>namun jika dibuat adanya response baru bisa</p>
<p>so lets say ginilah, oh ternyata di akses di request get (tanpa origin), maka gak bakal disetel</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="glosarium.html" class="btn btn-neutral float-right" title="Glosarium" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="docker-mern.html" class="btn btn-neutral float-left" title="Docker MERN (Mongo Express React Node)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Ryan

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>